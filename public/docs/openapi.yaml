openapi: 3.1.0
info:
  title: Almacen Principal
  description: |
    API para gestión de usuarios con autenticación por tokens (Laravel Sanctum).
    Respuestas JSON unificadas `{status, mensaje, data}`.
  version: 1.0.0
servers:
  - url: http://localhost
    description: Desarrollo local
  - url: https://almacen.alwaysdata.net
    description: Producción

security:
  - bearerAuth: []

paths:
  # ========================================
  # AUTENTICACIÓN
  # ========================================
  /api/login:
    post:
      summary: Iniciar sesión
      tags: [Autenticación]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email: { type: string, format: email }
                password: { type: string, format: password }
      responses:
        '200':
          description: Sesión iniciada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/logout:
    post:
      summary: Cerrar sesión
      tags: [Autenticación]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Sesión cerrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/me:
    get:
      summary: Información del usuario autenticado
      tags: [Autenticación]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Datos del usuario
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/users/password/forgot:
    post:
      summary: Solicitar restablecimiento de contraseña
      tags: [Autenticación]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email: { type: string, format: email }
      responses:
        '200':
          description: Token de restablecimiento enviado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/users/password/reset:
    post:
      summary: Restablecer contraseña con token
      tags: [Autenticación]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                token: { type: string }
                password: { type: string, format: password }
                password_confirmation: { type: string, format: password }
      responses:
        '200':
          description: Contraseña restablecida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # USUARIOS
  # ========================================
  /api/users:
    get:
      summary: Listar usuarios
      tags: [Usuarios]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de usuarios
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear usuario
      tags: [Usuarios]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRequest'
      responses:
        '201':
          description: Usuario creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/users/{id}:
    get:
      summary: Ver detalle de usuario
      tags: [Usuarios]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle del usuario
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar usuario
      tags: [Usuarios]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRequest'
      responses:
        '200':
          description: Usuario actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar usuario
      tags: [Usuarios]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Usuario eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/users/change-password:
    post:
      summary: Cambiar contraseña del usuario autenticado
      tags: [Usuarios]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - password_actual
                - password_nueva
                - repetir_password
              properties:
                password_actual: { type: string, format: password, description: "Contraseña actual del usuario" }
                password_nueva: { type: string, format: password, description: "Nueva contraseña (mín 8 caracteres, mayúscula, minúscula, número, símbolo)" }
                repetir_password: { type: string, format: password, description: "Repetir la nueva contraseña (debe coincidir)" }
      responses:
        '200':
          description: Respuesta de cambio de contraseña (éxito o error de validación)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/users/email/{email}:
    get:
      summary: Ver usuario por email
      tags: [Usuarios]
      security:
        - bearerAuth: []
      parameters:
        - name: email
          in: path
          required: true
          schema: { type: string, format: email }
      responses:
        '200':
          description: Usuario encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar usuario por email
      tags: [Usuarios]
      security:
        - bearerAuth: []
      parameters:
        - name: email
          in: path
          required: true
          schema: { type: string, format: email }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRequest'
      responses:
        '200':
          description: Usuario actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/users/email/{email}/password:
    put:
      summary: Cambiar contraseña por email
      tags: [Usuarios]
      security:
        - bearerAuth: []
      parameters:
        - name: email
          in: path
          required: true
          schema: { type: string, format: email }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                password: { type: string, format: password }
      responses:
        '200':
          description: Contraseña actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/users/cedula/{cedula}:
    get:
      summary: Ver usuario por cédula
      tags: [Usuarios]
      security:
        - bearerAuth: []
      parameters:
        - name: cedula
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: Usuario encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar usuario por cédula
      tags: [Usuarios]
      security:
        - bearerAuth: []
      parameters:
        - name: cedula
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRequest'
      responses:
        '200':
          description: Usuario actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/users/cedula/{cedula}/password:
    put:
      summary: Cambiar contraseña por cédula
      tags: [Usuarios]
      security:
        - bearerAuth: []
      parameters:
        - name: cedula
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                password: { type: string, format: password }
      responses:
        '200':
          description: Contraseña actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # HOSPITALES
  # ========================================
  /api/hospitales:
    get:
      summary: Listar hospitales
      tags: [Hospitales]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de hospitales
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear hospital
      tags: [Hospitales]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HospitalRequest'
      responses:
        '201':
          description: Hospital creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/hospitales/{id}:
    get:
      summary: Ver detalle de hospital
      tags: [Hospitales]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle del hospital
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar hospital
      tags: [Hospitales]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HospitalRequest'
      responses:
        '200':
          description: Hospital actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar hospital
      tags: [Hospitales]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Hospital eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/hospitales/cod_sicm/{cod_sicm}:
    get:
      summary: Ver hospital por COD_SICM
      tags: [Hospitales]
      security:
        - bearerAuth: []
      parameters:
        - name: cod_sicm
          in: path
          required: true
          schema: { type: string }
          description: Código SICM del hospital
          example: "SICM-001"
      responses:
        '200':
          description: Hospital encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar hospital por COD_SICM
      tags: [Hospitales]
      security:
        - bearerAuth: []
      parameters:
        - name: cod_sicm
          in: path
          required: true
          schema: { type: string }
          description: Código SICM del hospital
          example: "SICM-001"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HospitalRequest'
      responses:
        '200':
          description: Hospital actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/hospitales/buscar_por_rif:
    get:
      summary: Buscar hospital por RIF
      tags: [Hospitales]
      security:
        - bearerAuth: []
      parameters:
        - name: rif
          in: query
          required: true
          schema: { type: string }
      responses:
        '200':
          description: Hospital encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # SEDES
  # ========================================
  /api/sedes:
    get:
      summary: Listar sedes
      description: |
        Retorna un listado paginado de sedes con información del hospital asociado.
        Incluye datos del hospital como: id, nombre, nombre_completo, rif, cod_sicm, codigo_alt, email, telefono, tipo, status.
      tags: [Sedes]
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          required: false
          schema: { type: string, enum: [activo, inactivo, todos] }
          description: Filtrar por estado (por defecto activo)
      responses:
        '200':
          description: Listado de sedes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear sede
      tags: [Sedes]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SedeRequest'
      responses:
        '201':
          description: Sede creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/sedes/{id}:
    get:
      summary: Ver detalle de sede
      description: |
        Retorna los detalles de una sede específica incluyendo información completa del hospital asociado.
        El hospital incluye: id, nombre, nombre_completo, rif, cod_sicm, codigo_alt, email, telefono, tipo, status.
      tags: [Sedes]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle de la sede
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar sede
      tags: [Sedes]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SedeRequest'
      responses:
        '200':
          description: Sede actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar sede
      tags: [Sedes]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Sede eliminada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/sedes/hospital/{id}:
    get:
      summary: Listar sedes por hospital
      description: |
        Retorna un listado paginado de sedes para un hospital específico.
        Incluye información completa del hospital: id, nombre, nombre_completo, rif, cod_sicm, codigo_alt, email, telefono, tipo, status.
      tags: [Sedes]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
          description: ID del hospital
        - name: status
          in: query
          required: false
          schema: { type: string, enum: [activo, inactivo, todos] }
          description: Filtrar por estado (por defecto activo)
      responses:
        '200':
          description: Sedes del hospital
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # SOLICITUDES
  # ========================================
  /api/solicitudes:
    get:
      summary: Listar todas las solicitudes
      tags: [Solicitudes]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de solicitudes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear nueva solicitud
      tags: [Solicitudes]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SolicitudRequest'
      responses:
        '201':
          description: Solicitud creada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/solicitudes/{solicitud}:
    get:
      summary: Obtener detalle de solicitud
      tags: [Solicitudes]
      security:
        - bearerAuth: []
      parameters:
        - name: solicitud
          in: path
          required: true
          schema: { type: integer }
          description: ID de la solicitud
      responses:
        '200':
          description: Detalle de solicitud
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar solicitud
      tags: [Solicitudes]
      security:
        - bearerAuth: []
      parameters:
        - name: solicitud
          in: path
          required: true
          schema: { type: integer }
          description: ID de la solicitud
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SolicitudRequest'
      responses:
        '200':
          description: Solicitud actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar solicitud
      tags: [Solicitudes]
      security:
        - bearerAuth: []
      parameters:
        - name: solicitud
          in: path
          required: true
          schema: { type: integer }
          description: ID de la solicitud
      responses:
        '200':
          description: Solicitud eliminada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/solicitudes/sede/{sede_id}:
    get:
      summary: Listar solicitudes por sede
      tags: [Solicitudes]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
          description: ID de la sede
      responses:
        '200':
          description: Solicitudes de la sede
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/solicitudes/hospital/{hospital_id}:
    get:
      summary: Listar solicitudes por hospital
      tags: [Solicitudes]
      security:
        - bearerAuth: []
      parameters:
        - name: hospital_id
          in: path
          required: true
          schema: { type: integer }
          description: ID del hospital
      responses:
        '200':
          description: Solicitudes del hospital
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # ALMACENES PRINCIPALES
  # ========================================
  /api/almacenes_principales:
    get:
      summary: Listar almacenes principales
      tags: [Almacenes Principales]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de almacenes principales
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear almacén principal
      tags: [Almacenes Principales]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenPrincipalRequest'
      responses:
        '201':
          description: Almacén principal creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/almacenes_principales/{id}:
    get:
      summary: Ver detalle de almacén principal
      tags: [Almacenes Principales]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle del almacén principal
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar almacén principal
      tags: [Almacenes Principales]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenPrincipalRequest'
      responses:
        '200':
          description: Almacén principal actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar almacén principal
      tags: [Almacenes Principales]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Almacén principal eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # ALMACENES CENTRALES
  # ========================================
  /api/almacenes_centrales:
    get:
      summary: Listar almacenes centrales
      tags: [Almacenes Centrales]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de almacenes centrales
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear almacén central
      tags: [Almacenes Centrales]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenCentralRequest'
      responses:
        '201':
          description: Almacén central creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/almacenes_centrales/{id}:
    get:
      summary: Ver detalle de almacén central
      tags: [Almacenes Centrales]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle del almacén central
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar almacén central
      tags: [Almacenes Centrales]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenCentralRequest'
      responses:
        '200':
          description: Almacén central actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar almacén central
      tags: [Almacenes Centrales]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Almacén central eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # ALMACENES DE FARMACIA
  # ========================================
  /api/almacenes_farmacia:
    get:
      summary: Listar almacenes de farmacia
      tags: [Almacenes Farmacia]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de almacenes de farmacia
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear almacén de farmacia
      tags: [Almacenes Farmacia]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenFarmaciaRequest'
      responses:
        '201':
          description: Almacén de farmacia creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/almacenes_farmacia/{id}:
    get:
      summary: Ver detalle de almacén de farmacia
      tags: [Almacenes Farmacia]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle del almacén de farmacia
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar almacén de farmacia
      tags: [Almacenes Farmacia]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenFarmaciaRequest'
      responses:
        '200':
          description: Almacén de farmacia actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar almacén de farmacia
      tags: [Almacenes Farmacia]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Almacén de farmacia eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # ALMACENES PARALELOS
  # ========================================
  /api/almacenes_paralelo:
    get:
      summary: Listar almacenes paralelos
      tags: [Almacenes Paralelos]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de almacenes paralelos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear almacén paralelo
      tags: [Almacenes Paralelos]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenParaleloRequest'
      responses:
        '201':
          description: Almacén paralelo creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/almacenes_paralelo/{id}:
    get:
      summary: Ver detalle de almacén paralelo
      tags: [Almacenes Paralelos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle del almacén paralelo
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar almacén paralelo
      tags: [Almacenes Paralelos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenParaleloRequest'
      responses:
        '200':
          description: Almacén paralelo actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar almacén paralelo
      tags: [Almacenes Paralelos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Almacén paralelo eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # ALMACENES SERVICIOS ATENCIONES
  # ========================================
  /api/almacenes_servicios_atenciones:
    get:
      summary: Listar almacenes de servicios de atenciones
      tags: [Almacenes Servicios Atenciones]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de almacenes de servicios de atenciones
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear almacén de servicios de atenciones
      tags: [Almacenes Servicios Atenciones]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenServiciosAtencionesRequest'
      responses:
        '201':
          description: Almacén de servicios de atenciones creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/almacenes_servicios_atenciones/{id}:
    get:
      summary: Ver detalle de almacén de servicios de atenciones
      tags: [Almacenes Servicios Atenciones]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle del almacén de servicios de atenciones
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar almacén de servicios de atenciones
      tags: [Almacenes Servicios Atenciones]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenServiciosAtencionesRequest'
      responses:
        '200':
          description: Almacén de servicios de atenciones actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar almacén de servicios de atenciones
      tags: [Almacenes Servicios Atenciones]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Almacén de servicios de atenciones eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # ALMACENES SERVICIOS APOYO
  # ========================================
  /api/almacenes_servicios_apoyo:
    get:
      summary: Listar almacenes de servicios de apoyo
      tags: [Almacenes Servicios Apoyo]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de almacenes de servicios de apoyo
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear almacén de servicios de apoyo
      tags: [Almacenes Servicios Apoyo]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenServiciosApoyoRequest'
      responses:
        '201':
          description: Almacén de servicios de apoyo creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/almacenes_servicios_apoyo/{id}:
    get:
      summary: Ver detalle de almacén de servicios de apoyo
      tags: [Almacenes Servicios Apoyo]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle del almacén de servicios de apoyo
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar almacén de servicios de apoyo
      tags: [Almacenes Servicios Apoyo]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlmacenServiciosApoyoRequest'
      responses:
        '200':
          description: Almacén de servicios de apoyo actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar almacén de servicios de apoyo
      tags: [Almacenes Servicios Apoyo]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Almacén de servicios de apoyo eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # INSUMOS
  # ========================================
  /api/insumos:
    get:
      summary: Listar insumos
      tags: [Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [activo, inactivo, todos]
            default: activo
      responses:
        '200':
          description: Listado de insumos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/movimiento/almacen/salida:
    post:
      summary: Registrar salida de almacén
      description: |
        Registra un movimiento de salida desde un almacén de origen hacia un almacén de destino.
        
        **Funcionalidad:**
        - Crea un grupo de lotes con un código único (`codigo_grupo`) en la tabla `lotes_grupos`
        - Genera un movimiento de stock con estado "pendiente" en la tabla `movimientos_stock`
        - Registra la suma total de cantidades de todos los items en el campo `cantidad_salida_total`
        - **Descuenta las cantidades del almacén de origen**
        - Actualiza el status a `false` si la cantidad llega a 0
        
        **Validaciones:**
        - Todos los lotes deben existir en el almacén central del hospital/sede origen
        - Debe haber stock suficiente para cada lote
        - Los lotes deben tener status `true` (activos)
        
        **Campos requeridos:**
        - IDs de hospital y sede de origen y destino
        - Tipos de almacén de origen y destino
        - Lista de items con lote_id y cantidad
        
        **Respuesta exitosa:** Retorna el `codigo_grupo` generado para el movimiento.
      tags: [Movimientos]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MovimientoCentralSalidaRequest'
            examples:
              despacho-multiple:
                value:
                  origen_hospital_id: 1
                  origen_sede_id: 1
                  destino_hospital_id: 2
                  destino_sede_id: 2
                  origen_almacen_tipo: almacenCent
                  destino_almacen_tipo: almacenPrin
                  tipo_movimiento: despacho
                  fecha_despacho: '2025-09-29'
                  observaciones: 'Despacho de insumos médicos'
                  items:
                    - lote_id: 1
                      cantidad: 200
                    - lote_id: 2
                      cantidad: 100
      responses:
        '200':
          description: Respuesta del endpoint (éxito o error con status=false)
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/StandardResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
              examples:
                exito:
                  value:
                    status: true
                    mensaje: Movimiento desde central aplicado.
                    data:
                      codigo_grupo: cod001
                validacion-error:
                  value:
                    status: false
                    mensaje: "Los datos proporcionados no son válidos."
                    errors:
                      origen_hospital_id: ["El campo origen hospital id es obligatorio."]
                      origen_almacen_tipo: ["El campo origen almacen tipo es obligatorio."]
                      items: ["El campo items debe contener al menos 1 elementos."]
                stock-insuficiente:
                  value:
                    status: false
                    mensaje: "Stock insuficiente en el almacén central para el lote 1. Disponible: 50, Solicitado: 200"
                    data: null
                lote-no-encontrado:
                  value:
                    status: false
                    mensaje: "No se encontró el lote 2 en el almacén central para el hospital 1 y sede 1."
                    data: null
                error-inesperado:
                  value:
                    status: false
                    mensaje: "Error inesperado al registrar el movimiento."
                    data: null

  /api/movimiento/almacen/entrada:
    post:
      summary: Confirmar recepción en almacén
      description: |
        Confirma la recepción de un movimiento de stock en el almacén de destino.
        
        **Funcionalidad:**
        - Actualiza el campo `cantidad_entrada` en la tabla `lotes_grupos`
        - Actualiza el campo `cantidad_entrada_total` en la tabla `movimientos_stock` 
        - Registra la fecha de recepción y usuario receptor
        - Actualiza el stock en el almacén de destino
        - Cambia el status de lotes_grupos a 'recibido'
        - Marca `discrepancia = true` en lotes_grupos si cantidad_entrada ≠ cantidad_salida
        - Marca `discrepancia_total = true` si cantidad_entrada_total ≠ cantidad_salida_total
        - **Registra automáticamente** discrepancias en tabla `movimientos_discrepancias`
      tags: [Movimientos]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MovimientoPrincipalEntradaRequest'
            examples:
              recepcion-completa:
                value:
                  movimiento_stock_id: 1
                  fecha_recepcion: "2025-10-02"
                  user_id_receptor: 3
                  items:
                    - lote_id: 1
                      cantidad: 200
                    - lote_id: 2
                      cantidad: 100
              recepcion-con-discrepancia:
                value:
                  movimiento_stock_id: 1
                  fecha_recepcion: "2025-10-02"
                  user_id_receptor: 3
                  items:
                    - lote_id: 1
                      cantidad: 200
                    - lote_id: 2
                      cantidad: 80
      responses:
        '200':
          description: Respuesta del endpoint (éxito o error con status=false)
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/MovimientoPrincipalEntradaResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
              examples:
                completado:
                  value:
                    status: true
                    mensaje: Recepción confirmada y stock actualizado.
                    data:
                      estado: recibido
                      discrepancias: []
                inconsistencias:
                  value:
                    status: true
                    mensaje: Recepción registrada con discrepancias. Se generó un reporte automático.
                    data:
                      estado: recibido
                      discrepancias:
                        - lote_id: 2
                          cantidad_esperada: 500
                          cantidad_recibida: 450
                items-no-entregados:
                  value:
                    status: false
                    mensaje: "Los items deben estar en estado \"entregado\" antes de poder ser recibidos. Estado actual: activo (pendiente)."
                    data: null
                movimiento-no-encontrado:
                  value:
                    status: false
                    mensaje: "No existe un movimiento con el ID indicado."
                    data: null
                estado-invalido-central:
                  value:
                    status: false
                    mensaje: "El movimiento debe estar en estado: entregado para poder ser recibido. Tipo de movimiento: con repartidor (Central → Principal). Estado actual: despachado"
                    data: null
                estado-invalido-principal:
                  value:
                    status: false
                    mensaje: "El movimiento debe estar en estado: despachado, entregado para poder ser recibido. Tipo de movimiento: interno (Principal → Otros almacenes). Estado actual: pendiente"
                    data: null
        '500':
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/despachos-pacientes:
    get:
      summary: Listar despachos a pacientes
      tags: [Despachos Pacientes]
      security:
        - bearerAuth: []
      parameters:
        - name: hospital_id
          in: query
          schema: { type: integer }
        - name: sede_id
          in: query
          schema: { type: integer }
        - name: estado
          in: query
          schema: { type: string, enum: [pendiente, despachado, entregado, cancelado] }
        - name: paciente_cedula
          in: query
          schema: { type: string }
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
        - name: per_page
          in: query
          schema: { type: integer, default: 15 }
      responses:
        '200':
          description: Lista de despachos
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      data: { type: array, items: { $ref: '#/components/schemas/DespachoPaciente' } }
                      current_page: { type: integer }
                      total: { type: integer }
    post:
      summary: Crear despacho a paciente
      tags: [Despachos Pacientes]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [hospital_id, sede_id, fecha_despacho, paciente_nombres, paciente_apellidos, paciente_cedula, items]
              properties:
                hospital_id: { type: integer }
                sede_id: { type: integer }
                fecha_despacho: { type: string, format: date }
                observaciones: { type: string }
                paciente_nombres: { type: string }
                paciente_apellidos: { type: string }
                paciente_cedula: { type: string }
                genero: { type: string, enum: [M, F, O] }
                paciente_telefono: { type: string }
                paciente_direccion: { type: string }
                medico_tratante: { type: string }
                diagnostico: { type: string }
                indicaciones_medicas: { type: string }
                items:
                  type: array
                  items:
                    type: object
                    properties:
                      lote_id: { type: integer }
                      cantidad: { type: integer }
      responses:
        '200':
          description: Despacho creado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: object
                    properties:
                      codigo_despacho: { type: string }
                      paciente: { type: object }
                      total_items: { type: integer }

  /api/despachos-pacientes/paciente/{cedula}:
    get:
      summary: Obtener todos los despachos de un paciente por cédula
      description: |
        Retorna todos los despachos realizados a un paciente específico identificado por su cédula.
        Incluye información del paciente, estadísticas de despachos e insumos despachados en cada uno.
      tags: [Despachos Pacientes]
      security:
        - bearerAuth: []
      parameters:
        - name: cedula
          in: path
          required: true
          schema: { type: string }
          description: Cédula del paciente
      responses:
        '200':
          description: Despachos del paciente obtenidos exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: object
                    properties:
                      paciente:
                        type: object
                        properties:
                          cedula: { type: string }
                          nombres: { type: string }
                          apellidos: { type: string }
                          genero: { type: string, enum: [M, F, O], nullable: true }
                          telefono: { type: string, nullable: true }
                          direccion: { type: string, nullable: true }
                      estadisticas:
                        type: object
                        properties:
                          total_despachos: { type: integer }
                          por_estado:
                            type: object
                            description: Conteo de despachos por estado
                          total_items_despachados: { type: integer }
                          hospitales_involucrados: { type: integer }
                          sedes_involucradas: { type: integer }
                      despachos:
                        type: array
                        items:
                          allOf:
                            - $ref: '#/components/schemas/DespachoPaciente'
                            - type: object
                              properties:
                                insumos_despachados:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      lote_grupo_id: { type: integer }
                                      lote_id: { type: integer }
                                      cantidad_salida: { type: integer }
                                      numero_lote: { type: string }
                                      fecha_vencimiento: { type: string, format: date }
                                      insumo_id: { type: integer }
                                      insumo_nombre: { type: string }
                                      insumo_codigo: { type: string }
                                      insumo_presentacion: { type: string }
        '400':
          description: Cédula requerida
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data: { type: null }
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/despachos-pacientes/{id}:
    get:
      summary: Ver despacho específico
      tags: [Despachos Pacientes]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Despacho encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data: { $ref: '#/components/schemas/DespachoPaciente' }
    put:
      summary: Actualizar despacho
      tags: [Despachos Pacientes]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                observaciones: { type: string }
                genero: { type: string, enum: [M, F, O] }
                paciente_telefono: { type: string }
                paciente_direccion: { type: string }
                medico_tratante: { type: string }
                diagnostico: { type: string }
                indicaciones_medicas: { type: string }
      responses:
        '200':
          description: Despacho actualizado
    delete:
      summary: Eliminar despacho
      tags: [Despachos Pacientes]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Despacho eliminado

  /api/despachos-pacientes/sede/{sede_id}:
    get:
      summary: Listar despachos por sede con datos de insumos
      tags: [Despachos Pacientes]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
        - name: estado
          in: query
          schema: { type: string, enum: [pendiente, despachado, entregado, cancelado] }
        - name: paciente_cedula
          in: query
          schema: { type: string }
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
        - name: per_page
          in: query
          schema: { type: integer, default: 15 }
      responses:
        '200':
          description: Lista de despachos por sede con insumos
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      data: 
                        type: array
                        items: 
                          allOf:
                            - $ref: '#/components/schemas/DespachoPaciente'
                            - type: object
                              properties:
                                insumos_despachados:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      insumo_id: { type: integer }
                                      insumo_nombre: { type: string }
                                      insumo_codigo: { type: string }
                                      insumo_codigo_alterno: { type: string }
                                      insumo_presentacion: { type: string }
                                      lote_id: { type: integer }
                                      numero_lote: { type: string }
                                      fecha_vencimiento: { type: string, format: date }
                                      cantidad_despachada: { type: integer }
                                      lote_grupo_id: { type: integer }
                      current_page: { type: integer }
                      total: { type: integer }

  /api/estadisticas/dashboard:
    get:
      summary: Dashboard general de estadísticas (todas las sedes)
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Resumen general de estadísticas
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      resumen_insumos: { type: object }
                      resumen_movimientos: { type: object }
                      resumen_faltantes: { type: object }
                      resumen_pacientes: { type: object }
                      fecha_actualizacion: { type: string }

  /api/estadisticas/dashboard/sede/{sede_id}:
    get:
      summary: Dashboard de estadísticas específico por sede
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
          description: ID de la sede
      responses:
        '200':
          description: Resumen de estadísticas por sede
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      sede_info: { type: object }
                      resumen_insumos: { type: object }
                      resumen_movimientos: { type: object }
                      resumen_faltantes: { type: object }
                      resumen_pacientes: { type: object }
                      fecha_actualizacion: { type: string }

  /api/estadisticas/insumos:
    get:
      summary: Estadísticas de insumos generales (todas las sedes)
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Estadísticas de insumos
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      total_general: { type: integer }
                      nuevos_este_mes: { type: integer }
                      nuevos_mes_anterior: { type: integer }
                      porcentaje_cambio: { type: number }
                      tendencia: { type: string, enum: [aumento, disminucion, igual] }
                      mensaje_comparacion: { type: string }

  /api/estadisticas/insumos/sede/{sede_id}:
    get:
      summary: Estadísticas de insumos específicas por sede
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
          description: ID de la sede
      responses:
        '200':
          description: Estadísticas de insumos por sede
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      sede_info: { type: object }
                      total_general: { type: integer }
                      nuevos_este_mes: { type: integer }
                      nuevos_mes_anterior: { type: integer }
                      porcentaje_cambio: { type: number }
                      tendencia: { type: string, enum: [aumento, disminucion, igual] }
                      mensaje_comparacion: { type: string }

  /api/estadisticas/movimientos-estados:
    get:
      summary: Estadísticas de estados de movimientos generales
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: query
          schema: { type: integer }
          description: ID de la sede (opcional)
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
      responses:
        '200':
          description: Estadísticas por estado
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      sede_info: { type: object }
                      total_movimientos: { type: integer }
                      por_estado: { type: object }
                      porcentajes: { type: object }
                      periodo: { type: object }
                      desglose_sede: { type: object }

  /api/estadisticas/insumos-faltantes:
    get:
      summary: Insumos faltantes generales (todas las sedes)
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Insumos sin stock o con stock bajo
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      insumos_sin_stock: { type: object }
                      insumos_stock_bajo: { type: object }
                      resumen: { type: object }

  /api/estadisticas/insumos-faltantes/sede/{sede_id}:
    get:
      summary: Insumos faltantes específicos por sede
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
          description: ID de la sede
      responses:
        '200':
          description: Insumos sin stock o con stock bajo por sede
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      sede_info: { type: object }
                      tipo_almacen: { type: string }
                      insumos_sin_stock: { type: object }
                      insumos_stock_bajo: { type: object }
                      resumen: { type: object }

  /api/estadisticas/pacientes-estados:
    get:
      summary: Estadísticas de estados de despachos a pacientes generales
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
        - name: hospital_id
          in: query
          schema: { type: integer }
      responses:
        '200':
          description: Estadísticas de despachos por estado
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      total_despachos: { type: integer }
                      total_pacientes_unicos: { type: integer }
                      total_items_despachados: { type: integer }
                      por_estado: { type: object }
                      porcentajes: { type: object }
                      filtros_aplicados: { type: object }

  /api/ingresos-directos:
    get:
      summary: Listar ingresos directos
      tags: [Ingresos Directos]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: query
          schema: { type: integer }
          description: Filtrar por sede
        - name: hospital_id
          in: query
          schema: { type: integer }
          description: Filtrar por hospital
        - name: tipo_ingreso
          in: query
          schema: { type: string, enum: [donacion, compra, ajuste_inventario, devolucion, otro] }
          description: Tipo de ingreso
        - name: estado
          in: query
          schema: { type: string, enum: [registrado, procesado, cancelado] }
          description: Estado del ingreso
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
      responses:
        '200':
          description: Lista de ingresos directos
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      current_page: { type: integer }
                      data:
                        type: array
                        items:
                          type: object
                          properties:
                            id: { type: integer }
                            codigo_ingreso: { type: string }
                            tipo_ingreso: { type: string }
                            fecha_ingreso: { type: string, format: date }
                            sede_id: { type: integer }
                            hospital_id: { type: integer }
                            proveedor_nombre: { type: string }
                            numero_factura: { type: string }
                            valor_total: { type: number }
                            cantidad_total_items: { type: integer }
                            estado: { type: string }
                            observaciones: { type: string }
                            hospital: { type: object }
                            sede: { type: object }
                            usuario: { type: object }
                      total: { type: integer }
    post:
      summary: Registrar nuevo ingreso directo
      tags: [Ingresos Directos]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [tipo_ingreso, fecha_ingreso, sede_id, items]
              properties:
                tipo_ingreso:
                  type: string
                  enum: [donacion, compra, ajuste_inventario, devolucion, otro]
                fecha_ingreso:
                  type: string
                  format: date
                sede_id:
                  type: integer
                items:
                  type: array
                  minItems: 1
                  items:
                    type: object
                    required: [insumo_id, cantidad, numero_lote, fecha_vencimiento]
                    properties:
                      insumo_id: { type: integer }
                      cantidad: { type: integer, minimum: 1 }
                      numero_lote: { type: string }
                      fecha_vencimiento: { type: string, format: date }
                      precio_unitario: { type: number, minimum: 0 }
                proveedor_nombre: { type: string }
                proveedor_rif: { type: string }
                numero_factura: { type: string }
                observaciones: { type: string }
                motivo: { type: string }
      responses:
        '201':
          description: Ingreso registrado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: object
                    properties:
                      codigo_ingreso: { type: string }
                      codigo_lotes_grupo: { type: string }
                      tipo_ingreso: { type: string }
                      sede: { type: object }
                      cantidad_items: { type: integer }
                      valor_total: { type: number }
                      fecha_ingreso: { type: string, format: date }

  /api/ingresos-directos/sede/{sede_id}:
    get:
      summary: Listar ingresos directos por sede
      tags: [Ingresos Directos]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
          description: ID de la sede
        - name: tipo_ingreso
          in: query
          schema: { type: string, enum: [donacion, compra, ajuste_inventario, devolucion, otro] }
        - name: estado
          in: query
          schema: { type: string, enum: [registrado, procesado, cancelado] }
      responses:
        '200':
          description: Lista de ingresos por sede
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      current_page: { type: integer }
                      data: { type: array }
                      total: { type: integer }

  /api/ingresos-directos/{id}:
    get:
      summary: Ver detalles de un ingreso directo
      tags: [Ingresos Directos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
          description: ID del ingreso
      responses:
        '200':
          description: Detalles del ingreso
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      ingreso:
                        type: object
                        properties:
                          id: { type: integer }
                          codigo_ingreso: { type: string }
                          tipo_ingreso: { type: string }
                          fecha_ingreso: { type: string, format: date }
                          proveedor_nombre: { type: string }
                          numero_factura: { type: string }
                          valor_total: { type: number }
                          cantidad_total_items: { type: integer }
                          estado: { type: string }
                          observaciones: { type: string }
                          motivo: { type: string }
                          hospital: { type: object }
                          sede: { type: object }
                          usuario: { type: object }
                      lotes_detalle:
                        type: array
                        items:
                          type: object
                          properties:
                            insumo_id: { type: integer }
                            insumo_nombre: { type: string }
                            insumo_codigo: { type: string }
                            lote_id: { type: integer }
                            numero_lote: { type: string }
                            fecha_vencimiento: { type: string, format: date }
                            cantidad_ingresada: { type: integer }

  /api/estadisticas/pacientes-estados/sede/{sede_id}:
    get:
      summary: Estadísticas de estados de despachos a pacientes por sede específica
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
          description: ID de la sede
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
        - name: hospital_id
          in: query
          schema: { type: integer }
      responses:
        '200':
          description: Estadísticas de despachos por estado por sede
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      sede_info: { type: object }
                      total_despachos: { type: integer }
                      total_pacientes_unicos: { type: integer }
                      total_items_despachados: { type: integer }
                      por_estado: { type: object }
                      porcentajes: { type: object }
                      filtros_aplicados: { type: object }

  /api/estadisticas/insumos-recientes:
    get:
      summary: Estadísticas de insumos recientes por tipo de movimiento
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: query
          schema: { type: integer }
          description: ID de la sede (opcional)
        - name: limite
          in: query
          schema: { type: integer, minimum: 1, maximum: 50 }
          description: Número de insumos recientes a mostrar (default 3)
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
          description: Fecha de inicio del período (default últimos 30 días)
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
          description: Fecha de fin del período (default hoy)
      responses:
        '200':
          description: Insumos recientes por tipo de movimiento
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      sede_info: { type: object }
                      periodo:
                        type: object
                        properties:
                          desde: { type: string, format: date }
                          hasta: { type: string, format: date }
                      limite_resultados: { type: integer }
                      entradas:
                        type: object
                        properties:
                          totales:
                            type: array
                            items:
                              type: object
                              properties:
                                insumo_id: { type: integer }
                                insumo_nombre: { type: string }
                                insumo_codigo: { type: string }
                                insumo_presentacion: { type: string }
                                cantidad_total: { type: integer }
                                total_lotes: { type: integer }
                                fecha_reciente: { type: string, format: date-time }
                          por_movimientos: { type: array }
                          por_ingresos_directos: { type: array }
                          resumen:
                            type: object
                            properties:
                              total_insumos_diferentes: { type: integer }
                              cantidad_total: { type: integer }
                      salidas:
                        type: object
                        properties:
                          totales: { type: array }
                          resumen: { type: object }
                      transferencias:
                        type: object
                        properties:
                          insumos_recientes: { type: array }
                          resumen: { type: object }
                      despachos_pacientes:
                        type: object
                        properties:
                          insumos_recientes: { type: array }
                          resumen: { type: object }
                      fecha_actualizacion: { type: string }

  /api/estadisticas/insumos-recientes/sede/{sede_id}:
    get:
      summary: Estadísticas de insumos recientes específicas por sede
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
          description: ID de la sede
        - name: limite
          in: query
          schema: { type: integer, minimum: 1, maximum: 50 }
          description: Número de insumos recientes a mostrar (default 3)
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
      responses:
        '200':
          description: Insumos recientes por sede
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      sede_info:
                        type: object
                        properties:
                          sede_nombre: { type: string }
                          hospital_nombre: { type: string }
                          tipo_almacen: { type: string }
                      entradas: { type: object }
                      salidas: { type: object }
                      transferencias: { type: object }
                      despachos_pacientes: { type: object }

  /api/estadisticas/flujo-inventario:
    get:
      summary: Estadísticas completas de flujo de inventario (entradas, salidas, transferencias, despachos)
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: query
          schema: { type: integer }
          description: ID de la sede (opcional)
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
          description: Fecha de inicio del período (default primer día del mes actual)
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
          description: Fecha de fin del período (default último día del mes actual)
      responses:
        '200':
          description: Estadísticas completas de flujo de inventario con comparaciones mensuales
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      sede_info: { type: object }
                      periodo:
                        type: object
                        properties:
                          desde: { type: string, format: date }
                          hasta: { type: string, format: date }
                      entradas:
                        type: object
                        properties:
                          total: { type: integer }
                          por_movimientos: { type: integer }
                          por_ingresos_directos: { type: integer }
                          variacion_mes_anterior:
                            type: object
                            properties:
                              porcentaje: { type: number }
                              tendencia: { type: string, enum: [aumento, disminucion, igual] }
                              mensaje: { type: string }
                          detalle_variacion:
                            type: object
                            properties:
                              mes_actual: { type: integer }
                              mes_anterior: { type: integer }
                              diferencia: { type: integer }
                      salidas:
                        type: object
                        properties:
                          total: { type: integer }
                          variacion_mes_anterior: { type: object }
                          detalle_variacion: { type: object }
                      transferencias:
                        type: object
                        properties:
                          total: { type: integer }
                          por_estado:
                            type: object
                            properties:
                              pendiente: { type: integer }
                              despachado: { type: integer }
                              entregado: { type: integer }
                              recibido: { type: integer }
                              cancelado: { type: integer }
                          variacion_mes_anterior: { type: object }
                          detalle_variacion: { type: object }
                      despachos_pacientes:
                        type: object
                        properties:
                          total: { type: integer }
                          por_estado:
                            type: object
                            properties:
                              pendiente: { type: integer }
                              despachado: { type: integer }
                              entregado: { type: integer }
                              cancelado: { type: integer }
                          variacion_mes_anterior: { type: object }
                          detalle_variacion: { type: object }
                      resumen:
                        type: object
                        properties:
                          balance_neto: { type: integer }
                          rotacion_inventario: { type: number }
                          actividad_total: { type: integer }
                      fecha_actualizacion: { type: string }

  /api/estadisticas/flujo-inventario/sede/{sede_id}:
    get:
      summary: Estadísticas de flujo de inventario específicas por sede
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
          description: ID de la sede
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
          description: Fecha de inicio del período
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
          description: Fecha de fin del período
      responses:
        '200':
          description: Estadísticas de flujo por sede específica
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  data:
                    type: object
                    properties:
                      sede_info:
                        type: object
                        properties:
                          sede_nombre: { type: string }
                          hospital_nombre: { type: string }
                          tipo_almacen: { type: string }
                      periodo: { type: object }
                      entradas: { type: object }
                      salidas: { type: object }
                      transferencias: { type: object }
                      despachos_pacientes: { type: object }
                      resumen: { type: object }
                      fecha_actualizacion: { type: string }

  /api/estadisticas/hospitales-distribucion:
    get:
      summary: Estadísticas de hospitales por tipo y porcentajes de distribución
      description: |
        Obtiene el total de hospitales activos agrupados por tipo y muestra los porcentajes de distribución configurados.
        
        **Información proporcionada:**
        - Total de hospitales activos por cada tipo
        - Porcentaje asignado a cada tipo en la tabla `tipos_hospital_distribuciones`
        - Porcentaje individual que recibe cada hospital del tipo
        - Validación de que los porcentajes sumen 100%
        
        **Cálculo del porcentaje individual:**
        - Porcentaje individual = Porcentaje del tipo / Total de hospitales del tipo
        - Ejemplo: Tipo 1 = 15% / 138 hospitales = 0.11% por hospital
        - Se redondea a 2 decimales
        
        **Uso:**
        Este endpoint es útil para:
        - Verificar la distribución antes de ejecutar importaciones
        - Entender cómo se calculan los porcentajes individuales
        - Auditar la configuración de distribución
      tags: [Estadísticas]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Estadísticas de hospitales obtenidas exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Estadísticas de hospitales por tipo obtenidas exitosamente."
                  data:
                    type: object
                    properties:
                      total_hospitales_activos:
                        type: integer
                        example: 293
                        description: Total de hospitales activos en el sistema
                      por_tipo:
                        type: array
                        items:
                          type: object
                          properties:
                            tipo:
                              type: string
                              example: "hospital_tipo1"
                              description: Identificador del tipo de hospital
                            total_hospitales:
                              type: integer
                              example: 138
                              description: Cantidad de hospitales de este tipo
                            porcentaje_tipo:
                              type: number
                              format: float
                              example: 15.0
                              description: Porcentaje asignado al tipo en la configuración
                            porcentaje_individual:
                              type: number
                              format: float
                              example: 0.11
                              description: Porcentaje que recibe cada hospital (redondeado a 2 decimales)
                            descripcion:
                              type: string
                              example: "Cada hospital recibe 0.11% del total"
                              description: Mensaje descriptivo del cálculo
                      porcentajes_configurados:
                        type: object
                        properties:
                          tipo1:
                            type: number
                            format: float
                            example: 15.0
                          tipo2:
                            type: number
                            format: float
                            example: 30.0
                          tipo3:
                            type: number
                            format: float
                            example: 40.0
                          tipo4:
                            type: number
                            format: float
                            example: 15.0
                          total:
                            type: number
                            format: float
                            example: 100.0
                            description: Suma total de todos los porcentajes
                      fecha_consulta:
                        type: string
                        format: date-time
                        example: "2025-10-24 03:55:00"
                        description: Timestamp de cuando se realizó la consulta
        '200 (sin configuración)':
          description: No se encontró configuración de porcentajes
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  mensaje:
                    type: string
                    example: "No se encontró configuración de porcentajes de distribución."
                  data:
                    type: null

  /api/insumos/codigo/{codigo}:
    get:
      summary: Ver insumo por código
      tags: [Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: codigo
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: Insumo encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar insumo por código
      tags: [Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: codigo
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InsumoRequest'
      responses:
        '200':
          description: Insumo actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/insumos/sede/{sede_id}:
    get:
      summary: Listar insumos por sede
      tags: [Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Insumos de la sede
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # LOTES
  # ========================================
  /api/lotes:
    get:
      summary: Listar lotes
      tags: [Lotes]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de lotes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear lote
      tags: [Lotes]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoteRequest'
      responses:
        '201':
          description: Lote creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/lotes/{lote}:
    get:
      summary: Ver detalle de lote
      tags: [Lotes]
      security:
        - bearerAuth: []
      parameters:
        - name: lote
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle del lote
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar lote
      tags: [Lotes]
      security:
        - bearerAuth: []
      parameters:
        - name: lote
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoteRequest'
      responses:
        '200':
          description: Lote actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar lote
      tags: [Lotes]
      security:
        - bearerAuth: []
      parameters:
        - name: lote
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Lote eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/lotes/{lote}/almacenes:
    get:
      summary: Ver almacenes de un lote
      tags: [Lotes]
      security:
        - bearerAuth: []
      parameters:
        - name: lote
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Almacenes del lote
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Agregar lote a almacén
      tags: [Lotes]
      security:
        - bearerAuth: []
      parameters:
        - name: lote
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                almacen_id: { type: integer }
                cantidad: { type: integer }
      responses:
        '201':
          description: Lote agregado al almacén
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/lotes/{lote}/almacenes/{almacen_id}:
    delete:
      summary: Eliminar lote de almacén específico
      tags: [Lotes]
      security:
        - bearerAuth: []
      parameters:
        - name: lote
          in: path
          required: true
          schema: { type: integer }
        - name: almacen_id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Lote eliminado del almacén
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # LOTE-GRUPO
  # ========================================
  /api/lote-grupo:
    get:
      summary: Listar grupos de lote
      tags: [LoteGrupo]
      security:
        - bearerAuth: []
      parameters:
        - name: codigo
          in: query
          required: false
          schema: { type: string }
        - name: lote_id
          in: query
          required: false
          schema: { type: integer }
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [activo, inactivo]
      responses:
        '200':
          description: Lista de grupos de lote
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear grupo de lote
      tags: [LoteGrupo]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoteGrupoRequest'
      responses:
        '201':
          description: Grupo de lote creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/lote-grupo/{id}:
    put:
      summary: Actualizar grupo de lote
      tags: [LoteGrupo]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                cantidad: { type: integer, minimum: 1 }
                status: { type: string, enum: [activo, inactivo] }
      responses:
        '200':
          description: Grupo de lote actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar grupo de lote
      tags: [LoteGrupo]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Grupo de lote eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/lote-grupo/{codigo}:
    get:
      summary: Ver detalle de grupo de lote por código
      tags: [LoteGrupo]
      security:
        - bearerAuth: []
      parameters:
        - name: codigo
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: Detalle del grupo de lote
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/lote-grupo/crear-desde-movimiento:
    post:
      summary: Crear grupo de lote desde movimiento
      tags: [LoteGrupo]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoteGrupoMovimientoRequest'
      responses:
        '201':
          description: Grupo de lote creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/lote-grupo/estadisticas:
    get:
      summary: Obtener estadísticas de grupos de lote
      tags: [LoteGrupo]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Estadísticas de grupos de lote
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/distribucion/principal:
    post:
      summary: Distribución hacia almacén principal
      tags: [Distribución]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DistribucionPrincipalRequest'
      responses:
        '200':
          description: Distribución aplicada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/estadisticas/movimientos/hospital/{hospital_id}:
    get:
      summary: Obtener estadísticas de movimientos por hospital
      description: |
        Devuelve todos los movimientos de stock relacionados con un hospital específico, separados en dos grupos:
        
        **Movimientos Recibidos:** Movimientos que vienen de fuera del hospital (desde almacén central u otros hospitales).
        Estos tienen origen_hospital_id diferente a destino_hospital_id.
        
        **Movimientos Despachados:** Movimientos internos dentro del mismo hospital entre diferentes sedes/almacenes.
        Estos tienen origen_hospital_id igual a destino_hospital_id. Se agrupan por tipo de almacén destino.
      tags: [Estadísticas, Movimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: hospital_id
          in: path
          required: true
          schema: { type: integer }
          description: ID del hospital
      responses:
        '200':
          description: Estadísticas de movimientos obtenidas exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: object
                    properties:
                      hospital_id: { type: integer }
                      movimientos_recibidos:
                        type: object
                        description: Movimientos que vienen de fuera del hospital
                        properties:
                          descripcion: { type: string }
                          total: { type: integer }
                          movimientos: { type: array }
                      movimientos_despachados_por_almacen:
                        type: object
                        description: Movimientos internos agrupados por tipo de almacén
                        properties:
                          descripcion: { type: string }
                          total: { type: integer }
                          agrupados_por_tipo_almacen:
                            type: array
                            items:
                              type: object
                              properties:
                                tipo_almacen: { type: string }
                                nombre_almacen: { type: string }
                                total_movimientos: { type: integer }
                                movimientos: { type: array }
              examples:
                estadisticas-hospital:
                  value:
                    status: true
                    mensaje: Estadísticas de movimientos por hospital.
                    data:
                      hospital_id: 111
                      movimientos_recibidos:
                        descripcion: Movimientos que vienen de fuera del hospital (desde almacén central u otros hospitales)
                        total: 2
                        movimientos:
                          - id: 15
                            tipo: transferencia
                            destino_hospital_id: 111
                            destino_sede_id: 2
                            origen_hospital_id: 1
                            origen_sede_id: 1
                            destino_almacen_tipo: almacenPrin
                            estado: recibido
                            destino_hospital:
                              id: 111
                              nombre: Hospital Regional
                            origen_hospital:
                              id: 1
                              nombre: Almacén Central
                            lotes_grupos:
                              - id: 20
                                lote_id: 5
                                cantidad_entrada: 100
                                lote:
                                  numero_lote: LOTE-001
                                  insumo:
                                    nombre: Guantes quirúrgicos
                      movimientos_despachados_por_almacen:
                        descripcion: Movimientos internos dentro del hospital entre diferentes sedes/almacenes
                        total: 3
                        agrupados_por_tipo_almacen:
                          - tipo_almacen: almacenFarm
                            nombre_almacen: Almacén Farmacia
                            total_movimientos: 2
                            movimientos:
                              - id: 7
                                tipo: transferencia
                                origen_hospital_id: 111
                                destino_hospital_id: 111
                                origen_sede_id: 2
                                destino_sede_id: 8
                                origen_almacen_tipo: almacenPrin
                                destino_almacen_tipo: almacenFarm
                                estado: pendiente
                          - tipo_almacen: almacenPrin
                            nombre_almacen: Almacén Principal
                            total_movimientos: 1
                            movimientos:
                              - id: 8
                                tipo: transferencia
                                origen_hospital_id: 111
                                destino_hospital_id: 111
                                origen_almacen_tipo: almacenFarm
                                destino_almacen_tipo: almacenPrin
                                estado: completado
        '500':
          description: Error al obtener estadísticas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/estadisticas/inventario/hospital/{hospital_id}:
    get:
      summary: Obtener inventario consolidado por hospital
      description: |
        Devuelve todos los insumos del hospital agrupados por tipo de almacén (excluye almacén central).
        Incluye insumos de ingresos directos y un total general con sumas desglosadas.
      tags: [Estadísticas, Inventario]
      security:
        - bearerAuth: []
      parameters:
        - name: hospital_id
          in: path
          required: true
          schema: { type: integer }
          description: ID del hospital
      responses:
        '200':
          description: Inventario consolidado obtenido exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: object
                    properties:
                      hospital_id: { type: integer }
                      por_almacen:
                        type: object
                        description: Insumos agrupados por tipo de almacén
                      ingresos_directos:
                        type: object
                        description: Insumos provenientes de ingresos directos
                      total_general:
                        type: object
                        description: Total consolidado de todos los insumos
        '500':
          description: Error al obtener inventario
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/estadisticas/despachos-pacientes/hospital/{hospital_id}:
    get:
      summary: Obtener despachos a pacientes por hospital
      description: |
        Devuelve todos los despachos a pacientes del hospital con filtro de fecha.
        Incluye los insumos despachados y agrupa por paciente.
      tags: [Estadísticas, Despachos]
      security:
        - bearerAuth: []
      parameters:
        - name: hospital_id
          in: path
          required: true
          schema: { type: integer }
          description: ID del hospital
        - name: fecha
          in: query
          required: false
          schema: { type: string, format: date }
          description: Fecha de referencia (por defecto hoy)
        - name: tipo_filtro
          in: query
          required: false
          schema: { type: string, enum: [dia, mes, año, anio] }
          description: Tipo de filtro de fecha (por defecto dia)
      responses:
        '200':
          description: Despachos obtenidos exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: object
                    properties:
                      hospital_id: { type: integer }
                      filtro:
                        type: object
                        properties:
                          fecha: { type: string }
                          tipo: { type: string }
                      total_despachos: { type: integer }
                      total_pacientes: { type: integer }
                      despachos_por_paciente:
                        type: array
                        description: Despachos agrupados por paciente
        '500':
          description: Error al obtener despachos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/estadisticas/traza-insumo/hospital/{hospital_id}:
    get:
      summary: Obtener trazabilidad de insumo por hospital
      description: |
        Devuelve el seguimiento completo de un insumo desde almacén central hasta paciente.
        Separa los movimientos en:
        - Movimientos de entrada: desde almacén central al hospital
        - Movimientos internos: transferencias entre sedes del mismo hospital
        - Despachos a pacientes
        - Ingresos directos
        
        El resumen incluye: cantidad que entró al hospital, cantidad despachada a pacientes y cantidad que queda rodando.
      tags: [Estadísticas, Trazabilidad]
      security:
        - bearerAuth: []
      parameters:
        - name: hospital_id
          in: path
          required: true
          schema: { type: integer }
          description: ID del hospital
        - name: insumo_id
          in: query
          required: true
          schema: { type: integer }
          description: ID del insumo a rastrear
        - name: fecha
          in: query
          required: false
          schema: { type: string, format: date }
          description: Fecha de referencia (por defecto hoy)
        - name: tipo_filtro
          in: query
          required: false
          schema: { type: string, enum: [dia, semana, mes, anio] }
          description: Tipo de filtro de fecha (por defecto mes). Opciones - dia, semana, mes, anio
      responses:
        '200':
          description: Trazabilidad obtenida exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: object
                    properties:
                      hospital_id: { type: integer }
                      filtro:
                        type: object
                        properties:
                          fecha: { type: string }
                          tipo: { type: string }
                          fecha_desde: { type: string }
                          fecha_hasta: { type: string }
                      trazabilidad:
                        type: object
                        properties:
                          insumo:
                            type: object
                            properties:
                              id: { type: integer }
                              nombre: { type: string }
                              codigo: { type: string }
                              presentacion: { type: string }
                          movimientos_entrada:
                            type: object
                            description: Movimientos que entran al hospital desde almacén central
                            properties:
                              total: { type: integer }
                              cantidad_total_entrada: { type: integer }
                              detalle: { type: array, items: { type: object } }
                          movimientos_internos:
                            type: object
                            description: Transferencias entre sedes del mismo hospital
                            properties:
                              total: { type: integer }
                              cantidad_total_salida: { type: integer }
                              cantidad_total_entrada: { type: integer }
                              detalle: { type: array, items: { type: object } }
                          despachos_pacientes:
                            type: object
                            properties:
                              total: { type: integer }
                              cantidad_total: { type: integer }
                              total_pacientes: { type: integer }
                              detalle: { type: array, items: { type: object } }
                          ingresos_directos:
                            type: object
                            properties:
                              total: { type: integer }
                              cantidad_total: { type: integer }
                              detalle: { type: array, items: { type: object } }
                          resumen:
                            type: object
                            properties:
                              cantidad_entrada_hospital: { type: integer, description: "Total de unidades que entraron al hospital" }
                              cantidad_despachada_pacientes: { type: integer, description: "Total de unidades despachadas a pacientes" }
                              cantidad_rodando_hospital: { type: integer, description: "Cantidad que queda en el hospital (entrada - despachada)" }
        '400':
          description: Parámetro insumo_id requerido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Insumo no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error al obtener trazabilidad
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/movimientos-stock:
    get:
      summary: Listar movimientos de stock
      tags: [Movimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: per_page
          in: query
          required: false
          schema: { type: integer, minimum: 1, maximum: 100 }
          description: Tamaño de página para la paginación (por defecto 50, máximo 100)
        - name: estado
          in: query
          required: false
          schema:
            type: string
            enum: [pendiente, completado, inconsistente, cancelado]
        - name: destino_hospital_id
          in: query
          required: false
          schema: { type: integer }
        - name: destino_sede_id
          in: query
          required: false
          schema: { type: integer }
        - name: origen_hospital_id
          in: query
          required: false
          schema: { type: integer }
        - name: origen_sede_id
          in: query
          required: false
          schema: { type: integer }
        - name: codigo_grupo
          in: query
          required: false
          schema: { type: string }
      responses:
        '200':
          description: Listado paginado de movimientos de stock
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
    post:
      summary: Crear movimiento de stock
      tags: [Movimientos]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MovimientoStockRequest'
            examples:
              crear-movimiento:
                value:
                  tipo: transferencia
                  tipo_movimiento: ajuste
                  hospital_id: 1
                  sede_id: 1
                  origen_almacen_tipo: almacenCent
                  origen_almacen_id: 1
                  destino_almacen_tipo: almacenPrin
                  destino_almacen_id: 2
                  cantidad: 50
                  fecha_despacho: '2025-10-01'
                  observaciones: 'Movimiento manual'
                  estado: pendiente
      responses:
        '201':
          description: Movimiento creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/movimientos-stock/{id}:
    get:
      summary: Obtener detalle de movimiento de stock
      tags: [Movimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Movimiento encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: Movimiento no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Actualizar movimiento de stock
      tags: [Movimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MovimientoStockRequest'
            examples:
              actualizar-estado:
                value:
                  estado: completado
                  observaciones_recepcion: 'Recepción confirmada'
                  fecha_recepcion: '2025-10-02T10:00:00'
                  user_id_receptor: 5
      responses:
        '200':
          description: Movimiento actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: Movimiento no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Eliminar movimiento de stock
      tags: [Movimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Movimiento eliminado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: Movimiento no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/movimientos-stock/destino_sede/{destino_sede_id}:
    get:
      summary: Listar movimientos de stock por sede destino
      tags: [Movimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: destino_sede_id
          in: path
          required: true
          schema: { type: integer }
        - name: per_page
          in: query
          schema: { type: integer, minimum: 1, maximum: 100, default: 50 }
        - name: estado
          in: query
          schema: { type: string, enum: [pendiente, completado, inconsistente, cancelado] }
        - name: destino_hospital_id
          in: query
          schema: { type: integer }
      responses:
        '200':
          description: Movimientos de stock por sede destino
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/movimientos-stock/origen_sede/{origen_sede_id}:
    get:
      summary: Listar movimientos de stock por sede origen
      tags: [Movimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: origen_sede_id
          in: path
          required: true
          schema: { type: integer }
        - name: per_page
          in: query
          schema: { type: integer, minimum: 1, maximum: 100, default: 50 }
        - name: estado
          in: query
          schema: { type: string, enum: [pendiente, completado, inconsistente, cancelado] }
        - name: origen_hospital_id
          in: query
          schema: { type: integer }
      responses:
        '200':
          description: Movimientos de stock por sede origen
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/distribucion/automatica/central:
    post:
      summary: Distribución automática desde central
      tags: [Distribución]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DistribucionAutomaticaRequest'
      responses:
        '200':
          description: Distribución automática aplicada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # SEGUIMIENTOS (CRUD ADMINISTRACIÓN)
  # ========================================
  /api/seguimientos:
    get:
      summary: Listar seguimientos con filtros
      description: Obtiene una lista paginada de seguimientos con filtros opcionales
      tags: [Seguimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: movimiento_stock_id
          in: query
          schema: { type: integer }
          description: Filtrar por ID de movimiento
        - name: estado
          in: query
          schema: { type: string, enum: [despachado, en_camino, entregado] }
          description: Filtrar por estado
        - name: status
          in: query
          schema: { type: string, enum: [activo, completado] }
          description: Filtrar por status
        - name: user_id_repartidor
          in: query
          schema: { type: integer }
          description: Filtrar por repartidor
        - name: per_page
          in: query
          schema: { type: integer, default: 15 }
          description: Elementos por página
      responses:
        '200':
          description: Lista de seguimientos obtenida exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
    post:
      summary: Crear nuevo seguimiento
      description: Crea un nuevo registro de seguimiento
      tags: [Seguimientos]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SeguimientoRequest'
            examples:
              nuevo-seguimiento:
                value:
                  movimiento_stock_id: 1
                  estado: "despachado"
                  ubicacion:
                    lat: 10.480138
                    lng: -66.913861
                    direccion: "Almacén Central Hospital A"
                  observaciones: "Salida del almacén central"
                  user_id_repartidor: 5
      responses:
        '201':
          description: Seguimiento creado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/seguimientos/{id}:
    get:
      summary: Obtener seguimiento específico
      tags: [Seguimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Seguimiento obtenido exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: Seguimiento no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Actualizar seguimiento
      tags: [Seguimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SeguimientoUpdateRequest'
      responses:
        '200':
          description: Seguimiento actualizado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: Seguimiento no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Eliminar seguimiento
      tags: [Seguimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Seguimiento eliminado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: Seguimiento no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/seguimientos/movimiento/{movimiento_stock_id}:
    get:
      summary: Obtener seguimientos por movimiento
      description: Obtiene todos los seguimientos de un movimiento específico
      tags: [Seguimientos]
      security:
        - bearerAuth: []
      parameters:
        - name: movimiento_stock_id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Seguimientos del movimiento obtenidos exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # REPARTIDOR
  # ========================================
  /api/repartidor/seguimiento:
    post:
      summary: Actualizar seguimiento del repartidor
      description: |
        Permite al repartidor actualizar el estado de un movimiento.
        
        **Estados disponibles:**
        - `despachado`: Movimiento sale del origen
        - `en_camino`: Movimiento en tránsito (con ubicación GPS)
        - `entregado`: Movimiento llega al destino
        
        **Efectos:**
        - Crea registro en tabla `seguimientos`
        - Actualiza estado en `movimientos_stock`
        - Si estado = 'entregado', cambia `lotes_grupos` a 'entregado'
      tags: [Repartidor]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RepartidorSeguimientoRequest'
            examples:
              despachado:
                value:
                  movimiento_stock_id: 1
                  despachador_id: 5
                  estado: "despachado"
                  observaciones: "Saliendo del almacén central"
              en-camino:
                value:
                  movimiento_stock_id: 1
                  despachador_id: 5
                  estado: "en_camino"
                  ubicacion:
                    lat: 10.485123
                    lng: -66.918456
                    direccion: "Av. Principal, cerca del Hospital B"
                  observaciones: "En ruta hacia el destino"
              entregado:
                value:
                  movimiento_stock_id: 1
                  despachador_id: 5
                  estado: "entregado"
                  ubicacion:
                    lat: 10.490000
                    lng: -66.920000
                    direccion: "Hospital B - Almacén Principal"
                  observaciones: "Entregado al encargado del almacén"
      responses:
        '200':
          description: Respuesta del endpoint (éxito o error con status=false)
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/StandardResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
              examples:
                despachado:
                  value:
                    status: true
                    mensaje: "Movimiento marcado como despachado."
                    data: null
                en-camino:
                  value:
                    status: true
                    mensaje: "Ubicación actualizada - En camino."
                    data: null
                entregado:
                  value:
                    status: true
                    mensaje: "Movimiento marcado como entregado."
                    data: null
                error-validacion:
                  value:
                    status: false
                    mensaje: "Error de validación en los datos proporcionados."
                    data: null

  /api/repartidor/seguimiento/{movimiento_stock_id}:
    get:
      summary: Obtener historial de seguimiento
      description: Obtiene el historial completo de seguimiento de un movimiento
      tags: [Repartidor]
      security:
        - bearerAuth: []
      parameters:
        - name: movimiento_stock_id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Historial de seguimiento obtenido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: No se encontró seguimiento para este movimiento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/repartidor/movimientos:
    get:
      summary: Obtener movimientos asignados al repartidor
      description: Lista todos los movimientos asignados al repartidor autenticado
      tags: [Repartidor]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Movimientos del repartidor obtenidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/repartidor/movimientos-pendientes:
    get:
      summary: Obtener todos los movimientos pendientes para repartidores
      description: |
        Lista todos los movimientos con estado 'pendiente' disponibles para asignación a repartidores.
        Incluye información completa de origen, destino e insumos para cada movimiento.
      tags: [Repartidor]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: query
          schema: { type: integer, minimum: 1 }
          description: Filtro general - mostrar movimientos donde la sede sea origen O destino (tiene prioridad sobre filtros específicos)
        - name: origen_sede_id
          in: query
          schema: { type: integer, minimum: 1 }
          description: Filtrar específicamente por sede de origen (solo si no se usa sede_id)
        - name: destino_sede_id
          in: query
          schema: { type: integer, minimum: 1 }
          description: Filtrar específicamente por sede de destino (solo si no se usa sede_id)
        - name: fecha_desde
          in: query
          schema: { type: string, format: date }
          description: Filtrar desde fecha de creación
        - name: fecha_hasta
          in: query
          schema: { type: string, format: date }
          description: Filtrar hasta fecha de creación
        - name: per_page
          in: query
          schema: { type: integer, minimum: 1, maximum: 100, default: 15 }
          description: Número de elementos por página
      responses:
        '200':
          description: Movimientos pendientes obtenidos correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: object
                    properties:
                      movimientos:
                        type: array
                        items:
                          type: object
                          properties:
                            movimiento_id: { type: integer }
                            tipo: { type: string }
                            tipo_movimiento: { type: string }
                            cantidad_total: { type: integer }
                            fecha_despacho: { type: string, format: date-time, nullable: true }
                            fecha_creacion: { type: string, format: date-time }
                            observaciones: { type: string, nullable: true }
                            origen:
                              type: object
                              properties:
                                hospital_nombre: { type: string, nullable: true }
                                sede_nombre: { type: string, nullable: true }
                                sede_id: { type: integer, nullable: true }
                                almacen_tipo: { type: string, nullable: true }
                            destino:
                              type: object
                              properties:
                                hospital_nombre: { type: string, nullable: true }
                                sede_nombre: { type: string, nullable: true }
                                sede_id: { type: integer, nullable: true }
                                almacen_tipo: { type: string, nullable: true }
                            insumos:
                              type: array
                              items:
                                type: object
                                properties:
                                  insumo_id: { type: integer }
                                  nombre: { type: string }
                                  codigo: { type: string }
                                  presentacion: { type: string, nullable: true }
                                  tipo: { type: string, nullable: true }
                                  lote: { type: string }
                                  fecha_vencimiento: { type: string, format: date, nullable: true }
                                  cantidad: { type: integer }
                                  lote_grupo_codigo: { type: string }
                      pagination:
                        type: object
                        properties:
                          current_page: { type: integer }
                          per_page: { type: integer }
                          total: { type: integer }
                          last_page: { type: integer }
                          from: { type: integer, nullable: true }
                          to: { type: integer, nullable: true }
                      filtros_aplicados:
                        type: object
                        properties:
                          sede_id: { type: integer, nullable: true }
                          origen_sede_id: { type: integer, nullable: true }
                          destino_sede_id: { type: integer, nullable: true }
                          fecha_desde: { type: string, format: date, nullable: true }
                          fecha_hasta: { type: string, format: date, nullable: true }
                      total_movimientos_pendientes: { type: integer }
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/repartidor/movimientos-en-camino/{sede_id}:
    get:
      summary: Obtener movimientos en camino por sede
      description: |
        Lista todos los movimientos con estado 'en_camino' que tengan registros de seguimiento
        y estén relacionados con la sede especificada (como origen o destino).
      tags: [Repartidor]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer, minimum: 1 }
          description: ID de la sede (busca en origen_sede_id y destino_sede_id)
      responses:
        '200':
          description: Movimientos en camino obtenidos correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/MovimientoStockComplete'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/repartidor/movimientos-en-camino/origen/{sede_id}:
    get:
      summary: Obtener movimientos en camino por sede origen
      description: |
        Lista todos los movimientos con estado 'en_camino' que tengan registros de seguimiento
        y cuyo origen corresponda con la sede especificada.
      tags: [Repartidor]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer, minimum: 1 }
          description: ID de la sede origen (coincide con origen_sede_id)
      responses:
        '200':
          description: Movimientos en camino desde la sede origen obtenidos correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/MovimientoStockComplete'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/repartidor/movimientos-entregados/{sede_id}:
    get:
      summary: Obtener movimientos entregados/recibidos por sede
      description: |
        Lista todos los movimientos con estado 'entregado' o 'recibido' que tengan registros de seguimiento
        y estén relacionados con la sede especificada (como origen o destino).
      tags: [Repartidor]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema: { type: integer, minimum: 1 }
          description: ID de la sede (busca en origen_sede_id y destino_sede_id)
      responses:
        '200':
          description: Movimientos entregados obtenidos correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  mensaje: { type: string }
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/MovimientoStockComplete'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========================================
  # DISCREPANCIAS
  # ========================================
  # Las discrepancias se registran automáticamente cuando hay diferencias
  # entre cantidad_salida y cantidad_entrada en lotes_grupos durante la recepción.
  # También se pueden registrar manualmente para casos especiales.
  /api/movimientos-stock/discrepancias:
    get:
      summary: Listar discrepancias de movimientos
      description: Obtiene una lista paginada de discrepancias registradas
      tags: [Discrepancias]
      security:
        - bearerAuth: []
      parameters:
        - name: movimiento_stock_id
          in: query
          schema: { type: integer }
          description: Filtrar por ID de movimiento
        - name: codigo_lote_grupo
          in: query
          schema: { type: string }
          description: Filtrar por código de lote grupo
        - name: per_page
          in: query
          schema: { type: integer, minimum: 1, maximum: 100, default: 50 }
          description: Elementos por página
        - name: page
          in: query
          schema: { type: integer }
          description: Número de página
      responses:
        '200':
          description: Listado paginado de discrepancias
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
    post:
      summary: Registrar discrepancia de movimiento
      description: Crea un nuevo registro de discrepancia
      tags: [Discrepancias]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MovimientoDiscrepanciaRequest'
            examples:
              nueva-discrepancia:
                value:
                  movimiento_stock_id: 15
                  codigo_lote_grupo: "LG-2025-001"
                  cantidad_esperada: 100
                  cantidad_recibida: 95
                  observaciones: "Faltaron 5 unidades del lote"
      responses:
        '201':
          description: Discrepancia registrada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/movimientos-stock/discrepancias/{id}:
    get:
      summary: Obtener detalle de discrepancia
      tags: [Discrepancias]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle de discrepancia obtenido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: Discrepancia no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Actualizar discrepancia
      tags: [Discrepancias]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MovimientoDiscrepanciaRequest'
            examples:
              actualizar-discrepancia:
                value:
                  cantidad_recibida: 95
                  observaciones: 'Se ajustó tras reconteo'
      responses:
        '200':
          description: Discrepancia actualizada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: Discrepancia no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Eliminar discrepancia
      tags: [Discrepancias]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Discrepancia eliminada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '404':
          description: Discrepancia no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========================================
  # INVENTARIO
  # ========================================
  /api/inventario/registrar:
    post:
      summary: Registrar inventario
      tags: [Inventario]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                almacen_id: { type: integer }
                items: { type: array }
      responses:
        '200':
          description: Inventario registrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/inventario/sede/{sede_id}:
    get:
      summary: Obtener inventario por sede
      description: |
        Devuelve los insumos agrupados por `insumo_id` para la sede indicada.

        Cada lote incluye información del ingreso directo asociado cuando proviene de `ingresos_directos`.
        La fuente de stock depende del tipo de almacén configurado en la sede (almacenCent, almacenPrin, etc.).
      tags: [Inventario]
      security:
        - bearerAuth: []
      parameters:
        - name: sede_id
          in: path
          required: true
          schema:
            type: integer
          description: ID de la sede
      responses:
        '200':
          description: Listado de inventario agrupado por insumo y lotes con metadatos de ingreso directo.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    nullable: true
                    example: Inventario obtenido correctamente.
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/InventarioSedeItem'
              examples:
                ejemplo:
                  value:
                    status: true
                    mensaje: Inventario obtenido correctamente.
                    data:
                      - insumo_id: 125
                        insumo:
                          id: 125
                          codigo: "INS-00125"
                          nombre: "Guantes de Nitrilo"
                          tipo: "medico_quirurgico"
                          unidad_medida: "caja"
                          presentacion: "100 und"
                          status: "activo"
                        cantidad_total: 240
                        lotes:
                          - lote_id: 456
                            numero_lote: "LOT-20251229-001"
                            fecha_vencimiento: "2026-12-31"
                            cantidad: 120
                            ingreso_directo:
                              id: 8
                              codigo_ingreso: "ING-20251229-004"
                              tipo_ingreso: "ministerio"
                              fecha_ingreso: "2025-12-23"
                          - lote_id: 457
                            numero_lote: "LOT-20251229-002"
                            fecha_vencimiento: "2026-10-15"
                            cantidad: 120
                            ingreso_directo: null

  /api/inventario/hospital/{hospital_id}/por-vencer:
    get:
      summary: Obtener los 10 insumos próximos a vencer por hospital
      description: |
        Devuelve los 10 insumos más próximos a vencer del inventario de todas las sedes de un hospital específico.

        **Funcionalidad:**
        - Obtiene todas las sedes del hospital especificado
        - Filtra por hospital_id y status=true en todas las tablas de almacén
        - Solo incluye lotes con fecha de vencimiento válida (no NULL)
        - Solo incluye lotes que aún no han vencido (fecha >= hoy)
        - Ordena por fecha de vencimiento ascendente
        - Calcula los días restantes hasta el vencimiento
        - Limita el resultado a 10 registros
        - Incluye información de la sede donde se encuentra cada lote
      tags: [Inventario]
      security:
        - bearerAuth: []
      parameters:
        - name: hospital_id
          in: path
          required: true
          schema:
            type: integer
          description: ID del hospital
      responses:
        '200':
          description: Listado de insumos próximos a vencer
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Insumos próximos a vencer obtenidos exitosamente."
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        insumo_id:
                          type: integer
                          example: 42
                        codigo:
                          type: string
                          example: "42"
                        nombre:
                          type: string
                          example: "ACETAMINOFEN 500MG TABLETA"
                        presentacion:
                          type: string
                          example: "TABLETA"
                        tipo:
                          type: string
                          example: "farmaceutico"
                        lote_id:
                          type: integer
                          example: 15
                        numero_lote:
                          type: string
                          example: "BT24042"
                        fecha_vencimiento:
                          type: string
                          format: date
                          example: "2025-11-15"
                        cantidad:
                          type: integer
                          example: 1200
                        dias_para_vencer:
                          type: integer
                          example: 23
                          description: Número de días restantes hasta el vencimiento
                        sede_id:
                          type: integer
                          example: 1
                          description: ID de la sede donde se encuentra el lote
                        sede_nombre:
                          type: string
                          example: "Almacén Central"
                          description: Nombre de la sede donde se encuentra el lote
        '404':
          description: Hospital no encontrado o sin sedes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # TIPOS HOSPITAL DISTRIBUCIONES
  # ========================================
  /api/tipos_hospital_distribuciones:
    get:
      summary: Listar distribución de tipos de hospitales
      tags: [TiposHospitalDistribucion]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Listado de distribuciones
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear distribución de tipo de hospital
      tags: [TiposHospitalDistribucion]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [tipo, porcentaje]
              properties:
                tipo: { type: string }
                porcentaje: { type: number, format: float }
      responses:
        '200':
          description: Distribución creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/tipos_hospital_distribuciones/{id}:
    get:
      summary: Ver detalle de distribución
      tags: [TiposHospitalDistribucion]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: Detalle de la distribución
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # FICHAS DE INSUMOS
  # ========================================
  /api/ficha-insumos:
    get:
      summary: Listar fichas de insumos
      description: Obtiene un listado paginado de fichas de insumos con filtros opcionales
      tags: [Fichas de Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: hospital_id
          in: query
          schema:
            type: integer
          description: Filtrar por hospital
        - name: insumo_id
          in: query
          schema:
            type: integer
          description: Filtrar por insumo
        - name: status
          in: query
          schema:
            type: boolean
          description: Filtrar por estado
        - name: per_page
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
          description: Cantidad de resultados por página
      responses:
        '200':
          description: Listado de fichas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    post:
      summary: Crear una ficha de insumo
      description: Crea una nueva ficha de insumo para un hospital
      tags: [Fichas de Insumos]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - hospital_id
                - insumo_id
              properties:
                hospital_id:
                  type: integer
                  example: 5
                insumo_id:
                  type: integer
                  example: 123
                cantidad:
                  type: integer
                  default: 0
                  example: 0
                status:
                  type: boolean
                  default: true
                  example: true
      responses:
        '201':
          description: Ficha creada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/ficha-insumos/hospital/{hospital_id}:
    get:
      summary: Listar fichas de insumos por hospital
      description: |
        Devuelve un listado paginado de fichas de insumos pertenecientes a un hospital
        específico. Esta ruta es pública y no requiere token.
      tags: [Fichas de Insumos]
      security: []
      parameters:
        - name: hospital_id
          in: path
          required: true
          schema:
            type: integer
          description: Identificador del hospital
        - name: insumo_id
          in: query
          schema:
            type: integer
          description: Filtrar por un insumo específico
        - name: status
          in: query
          schema:
            type: boolean
          description: Filtrar por estado activo/inactivo de la ficha
        - name: per_page
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
          description: Cantidad de registros por página
      responses:
        '200':
          description: Listado de fichas del hospital
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/ficha-insumos/{id}:
    get:
      summary: Obtener detalle de una ficha
      tags: [Fichas de Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Detalle de la ficha
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    put:
      summary: Actualizar una ficha de insumo
      tags: [Fichas de Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                cantidad:
                  type: integer
                  example: 50
                status:
                  type: boolean
                  example: true
      responses:
        '200':
          description: Ficha actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

    delete:
      summary: Eliminar una ficha de insumo
      tags: [Fichas de Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Ficha eliminada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/ficha-insumos/generar/{hospital_id}:
    post:
      summary: Generar fichas de insumos para un hospital específico
      description: |
        Genera automáticamente fichas de todos los insumos activos para un hospital específico.
        Cada ficha se crea con cantidad = 0.
        
        **Casos de uso:**
        - Nuevo hospital registrado
        - Hospital sin fichas de insumos
        - Actualización masiva de fichas
      tags: [Fichas de Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: hospital_id
          in: path
          required: true
          schema:
            type: integer
          description: ID del hospital
      responses:
        '200':
          description: Fichas generadas exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Fichas de insumos generadas para el hospital."
                  data:
                    type: object
                    properties:
                      hospital_id:
                        type: integer
                        example: 5
                      hospital_nombre:
                        type: string
                        example: "Hospital Central"
                      total_insumos:
                        type: integer
                        example: 412
                      fichas_creadas:
                        type: integer
                        example: 412
                      fichas_existentes:
                        type: integer
                        example: 0
        '404':
          description: Hospital no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/ficha-insumos/generar-todos:
    post:
      summary: Generar fichas de insumos para TODOS los hospitales
      description: |
        Genera automáticamente fichas de todos los insumos activos para todos los hospitales activos.
        
        **Proceso:**
        1. Obtiene todos los hospitales con status = 'activo'
        2. Obtiene todos los insumos con status = true
        3. Crea fichas para cada combinación hospital-insumo que no exista
        
        **Advertencia:** Esta operación puede tardar varios minutos si hay muchos hospitales e insumos.
      tags: [Fichas de Insumos]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Fichas generadas exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Fichas de insumos generadas para todos los hospitales."
                  data:
                    type: object
                    properties:
                      hospitales_procesados:
                        type: integer
                        example: 289
                      total_insumos:
                        type: integer
                        example: 412
                      fichas_creadas:
                        type: integer
                        example: 119068
                      fichas_existentes:
                        type: integer
                        example: 0
        '404':
          description: No hay hospitales o insumos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/ficha-insumos/sincronizar-insumo/{insumo_id}:
    post:
      summary: Sincronizar un nuevo insumo en todos los hospitales
      description: |
        Cuando se registra un nuevo insumo, esta ruta crea automáticamente fichas
        para ese insumo en todos los hospitales activos.
        
        **Casos de uso:**
        - Nuevo insumo registrado
        - Insumo reactivado
        - Sincronización manual
      tags: [Fichas de Insumos]
      security:
        - bearerAuth: []
      parameters:
        - name: insumo_id
          in: path
          required: true
          schema:
            type: integer
          description: ID del insumo
      responses:
        '200':
          description: Insumo sincronizado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Insumo sincronizado en todos los hospitales."
                  data:
                    type: object
                    properties:
                      insumo_id:
                        type: integer
                        example: 413
                      insumo_nombre:
                        type: string
                        example: "Paracetamol 500mg"
                      hospitales_procesados:
                        type: integer
                        example: 289
                      fichas_creadas:
                        type: integer
                        example: 289
                      fichas_existentes:
                        type: integer
                        example: 0
        '404':
          description: Insumo no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  # ========================================
  # IMPORTACION EXCEL
  # ========================================
  /api/hospitales/import:
    post:
      summary: Importar hospitales desde Excel
      description: |
        Importa hospitales desde un archivo Excel (.xls o .xlsx).
        
        **Formato del archivo:**
        - Columna A: RIF (puede ser NULL o '?')
        - Columna B: COD_SICM (puede ser NULL o '?')
        - Columna C: Nombre (requerido)
        - Columna D: Tipo
        - Columna E: Dependencia
        - Columna F: Estado
        - Columna G: Municipio
        - Columna H: Parroquia
        - Columna I: Email
        - Columna J: Nombre Contacto
        - Columna K: Email Contacto
        - Columna L: Teléfono (máx 50 caracteres)
        - Columna M: Dirección
        - Columna N: Latitud
        - Columna O: Longitud
        
        **Procesamiento de datos:**
        - **Campos de texto convertidos a minúsculas:** dependencia, estado, municipio, parroquia
        - **Conversión UTF-8:** Se manejan correctamente acentos y caracteres especiales (girÓn → girón, alcalÁ → alcalá, josÉ → josé)
        - **Tipo de hospital:** Se normaliza automáticamente (I → hospital_tipo1, II → hospital_tipo2, etc.)
        - **Campos ignorados si son '?':** Todos los campos opcionales
        - **Duplicados:** Se detectan por COD_SICM o por nombre+estado+municipio (comparación insensible a mayúsculas)
      tags: [Importación Excel]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Archivo Excel (.xls o .xlsx) con los datos de hospitales
      responses:
        '200':
          description: Importación completada
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Importación completada."
                  data:
                    type: object
                    properties:
                      creados:
                        type: integer
                        example: 214
                      actualizados:
                        type: integer
                        example: 75
                      omitidos:
                        type: integer
                        example: 2
                      errores:
                        type: integer
                        example: 0
                      detalles_omitidos:
                        type: array
                        items:
                          type: object
                          properties:
                            fila:
                              type: integer
                            motivo:
                              type: string
                      detalles_errores:
                        type: array
                        items:
                          type: object
                          properties:
                            fila:
                              type: integer
                            error:
                              type: string
        '400':
          description: Error en el archivo
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/insumos/import:
    post:
      summary: Importar insumos desde archivo Excel
      description: |
        Importa insumos desde un archivo Excel (.xls o .xlsx).
        
        **Formato del archivo:**
        - Columna A: CODIGO (puede ser NULL)
        - Columna B: DESCRIPCION (requerido)
        
        **Funcionalidad:**
        - Busca insumos por código principal o código alterno
        - Crea nuevos insumos si no existen (asigna codigo=id automáticamente)
        - Actualiza información si ya existen
        - Parseo inteligente de descripciones para extraer tipo, presentación y unidades
        - **Soporte UTF-8:** Maneja correctamente acentos y caracteres especiales
        - **Detección automática:** Identifica tipo de archivo (.xls o .xlsx)
      tags: [Importación Excel]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
                  description: Archivo Excel (.xls o .xlsx) con datos de insumos
      responses:
        '200':
          description: Importación procesada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Importación procesada."
                  data:
                    type: object
                    properties:
                      creados:
                        type: integer
                        example: 25
                      actualizados:
                        type: integer
                        example: 10
                      omitidos:
                        type: integer
                        example: 0
                      omitidos_detalle:
                        type: array
                        items:
                          type: object
                          properties:
                            fila:
                              type: integer
                            motivo:
                              type: string
                      errores:
                        type: array
                        items:
                          type: object
                          properties:
                            row:
                              type: integer
                            descripcion:
                              type: string
                            error:
                              type: string
        '400':
          description: Error en el archivo o dependencias faltantes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/inventario/import:
    post:
      summary: Importar inventario desde archivo Excel
      description: |
        Importa inventario desde un archivo Excel (.xls o .xlsx) con el formato específico de columnas.
        
        **Formato del archivo:**
        - Columna A: NOMBRE DEL INSUMO (requerido)
        - Columna B: PRESENTACION
        - Columna C: LOTE (requerido)
        - Columna D: FECHA DE VENC. (opcional, NULL si es inválida)
        - Columna E: TOTAL UNIDADES (requerido)
        - Columna F: FECHA (fecha de ingreso, opcional, NULL si es inválida)
        
        **Funcionalidad:**
        - **Búsqueda/Creación de insumos:** Por nombre exacto en `insumos` (asigna codigo=id y codigo_alterno automáticamente)
        - **Creación/Actualización de lotes:** Por (insumo_id, numero_lote, hospital_id)
        - **Registro/Suma de stock:** En `almacenes_centrales` por (sede_id, lote_id, hospital_id)
        - **Parseo de fechas:** Excel serial o string (YYYY-MM-DD, DD/MM/YYYY, etc.)
        - **Fechas inválidas:** Se detectan (00/00/0000) y se guardan como NULL en la base de datos
        - **Detección automática:** Identifica tipo de archivo (.xls o .xlsx)
        - **Validaciones:** Nombres y lotes no vacíos, cantidades > 0
        
        **Parámetros opcionales:**
        - hospital_id: Por defecto 1 (almacén central)
        - sede_id: Por defecto 1
      tags: [Importación Excel]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
                  description: Archivo Excel (.xls o .xlsx) con datos de inventario
                hospital_id:
                  type: integer
                  description: ID del hospital destino (opcional, por defecto 1)
                  example: 1
                sede_id:
                  type: integer
                  description: ID de la sede destino (opcional, por defecto 1)
                  example: 1
      responses:
        '200':
          description: Importación procesada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Importación de inventario procesada."
                  data:
                    type: object
                    properties:
                      insumos_creados:
                        type: integer
                        example: 3
                      lotes_creados:
                        type: integer
                        example: 5
                      registros_stock_actualizados:
                        type: integer
                        example: 5
                      omitidos:
                        type: array
                        items:
                          type: object
                          properties:
                            fila:
                              type: integer
                            motivo:
                              type: string
                      errores:
                        type: array
                        items:
                          type: object
                          properties:
                            fila:
                              type: integer
                            error:
                              type: string
        '400':
          description: Datos inválidos o archivo no válido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/distribucion/import:
    post:
      summary: Importar y distribuir insumos desde Excel a todos los hospitales
      description: |
        Importa un archivo Excel con insumos y los distribuye automáticamente a todos los hospitales activos según porcentajes configurados por tipo de hospital.
        
        **Formato del archivo:**
        - Columna A: ITEM (número de ítem)
        - Columna B: DESCRIPCION (MATERIAL MMQ) - nombre exacto del insumo
        - Columna C: PARA DESPACHAR - cantidad total a distribuir
        
        **Proceso de distribución:**
        1. **Filtrado de hospitales:** Todos los hospitales activos (status=true)
        2. **Consulta de porcentajes:** Obtiene configuración de `tipos_hospital_distribuciones`
        3. **Cálculo de distribución:**
           - Aplica porcentaje según tipo de hospital (tipo1, tipo2, tipo3, tipo4)
           - Distribuye equitativamente entre hospitales del mismo tipo
           - **Trunca decimales** (no redondea) en todos los cálculos
        4. **Creación de movimientos:**
           - Tipo: despacho
           - Origen: almacenCent (hospital_id=1, sede_id=1)
           - Destino: almacenPrin de cada hospital
           - Estado: pendiente
        5. **Validaciones:**
           - Insumo debe existir en la base de datos
           - Stock suficiente en almacén central
           - Hospital destino debe tener sede principal configurada
        
        **Ejemplo de distribución:**
        - Total a despachar: 10000 unidades
        - Porcentaje Tipo I: 40% → 4000 unidades
        - Si hay 5 hospitales Tipo I → 800 unidades c/u
        - Decimales se truncan (no redondean)
      tags: [Importación Excel]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
                  description: Archivo Excel (.xls o .xlsx) con datos de distribución
      responses:
        '200':
          description: Distribución procesada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Distribución procesada exitosamente."
                  data:
                    type: object
                    properties:
                      insumos_distribuidos:
                        type: integer
                        example: 24
                        description: Número de insumos procesados exitosamente
                      movimientos_creados:
                        type: integer
                        example: 120
                        description: Total de movimientos de despacho creados
                      hospitales_totales:
                        type: integer
                        example: 25
                        description: Número total de hospitales activos
                      omitidos:
                        type: integer
                        example: 0
                        description: Filas omitidas por datos inválidos
                      errores:
                        type: integer
                        example: 0
                        description: Filas con errores
                      detalle_insumos:
                        type: array
                        items:
                          type: object
                          properties:
                            fila:
                              type: integer
                              example: 2
                            insumo:
                              type: string
                              example: "ACETAMINOFEN 120MG/5ML SUSPENSION"
                            cantidad_total:
                              type: integer
                              example: 64504
                            movimientos_creados:
                              type: integer
                              example: 8
                      detalle_omitidos:
                        type: array
                        items:
                          type: object
                          properties:
                            fila:
                              type: integer
                            motivo:
                              type: string
                      detalle_errores:
                        type: array
                        items:
                          type: object
                          properties:
                            fila:
                              type: integer
                            descripcion:
                              type: string
                            error:
                              type: string
        '400':
          description: Archivo inválido o configuración faltante
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

  /api/hospital/insumos/import:
    post:
      summary: Importar insumos de hospital desde Excel
      description: |
        Importa insumos específicos de un hospital desde un archivo Excel (.xls o .xlsx).
        Cada fila debe indicar la sede en la columna `id_sede`, lo que permite registrar el
        stock en el almacén que corresponda al tipo configurado para esa sede.
        Crea registros en lotes, ingresos_directos y lotes_grupos para trazabilidad completa.
      tags: [Importación Excel]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: Archivo Excel (.xls o .xlsx)
              required:
                - file
      responses:
        '200':
          description: Importación procesada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
              examples:
                success:
                  value:
                    status: true
                    mensaje: "Importación de insumos de hospital procesada."
                    data:
                      creados: 10
                      omitidos: 0
                      errores: 0
                      hospital_id: 1
                      usuario: "usuario@hospital.com"
        '400':
          description: Archivo inválido o datos incorrectos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'

# ========================================
# COMPONENTS
# ========================================
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    StandardResponse:
      type: object
      properties:
        status:
          type: boolean
          description: Indica si la operación fue exitosa
        mensaje:
          type: string
          description: Mensaje descriptivo del resultado
        data:
          type: object
          nullable: true
          description: Datos de la respuesta (opcional)

    ErrorResponse:
      type: object
      properties:
        status:
          type: boolean
          example: false
        mensaje:
          type: string
          example: "Error descriptivo"
        errors:
          type: object
          nullable: true
          example: {"campo": ["El campo es requerido"]}

    DespachoPaciente:
      type: object
      properties:
        id: { type: integer }
        hospital_id: { type: integer }
        sede_id: { type: integer }
        almacen_tipo: { type: string }
        fecha_despacho: { type: string, format: date }
        observaciones: { type: string, nullable: true }
        paciente_nombres: { type: string }
        paciente_apellidos: { type: string }
        paciente_cedula: { type: string }
        genero: { type: string, enum: [M, F, O], nullable: true }
        paciente_telefono: { type: string, nullable: true }
        paciente_direccion: { type: string, nullable: true }
        medico_tratante: { type: string, nullable: true }
        diagnostico: { type: string, nullable: true }
        indicaciones_medicas: { type: string, nullable: true }
        codigo_despacho: { type: string }
        cantidad_total_items: { type: integer }
        valor_total: { type: number, format: decimal, nullable: true }
        estado: { type: string, enum: [pendiente, despachado, entregado, cancelado] }
        fecha_entrega: { type: string, format: datetime, nullable: true }
        user_id: { type: integer }
        user_id_entrega: { type: integer, nullable: true }
        status: { type: boolean }
        created_at: { type: string, format: datetime }
        updated_at: { type: string, format: datetime }
        hospital: { type: object, nullable: true }
        sede: { type: object, nullable: true }
        usuario: { type: object, nullable: true }
        insumos_despachados:
          type: array
          items:
            type: object
            properties:
              insumo_id: { type: integer }
              insumo_nombre: { type: string }
              insumo_codigo: { type: string }
              insumo_codigo_alterno: { type: string }
              insumo_presentacion: { type: string }
              lote_id: { type: integer }
              numero_lote: { type: string }
              fecha_vencimiento: { type: string, format: date }
              cantidad_despachada: { type: integer }
              lote_grupo_id: { type: integer }

    UserRequest:
      type: object
      properties:
        name: { type: string }
        email: { type: string, format: email }
        password: { type: string, format: password }

    HospitalRequest:
      type: object
      properties:
        nombre: { type: string }
        rif: { type: string }
        direccion: { type: string }
        telefono: { type: string }

    SedeRequest:
      type: object
      properties:
        nombre: { type: string }
        hospital_id: { type: integer }
        direccion: { type: string }
        telefono: { type: string }

    SolicitudRequest:
      type: object
      required:
        - tipo_solicitud
        - descripcion
        - fecha
        - sede_id
        - hospital_id
      properties:
        tipo_solicitud: { type: string, enum: [insumo, servicio, mantenimiento, otro], description: "Tipo de solicitud" }
        descripcion: { type: string, description: "Descripción detallada de la solicitud" }
        prioridad: { type: string, enum: [baja, media, alta, urgente], default: media, description: "Nivel de prioridad" }
        fecha: { type: string, format: date, description: "Fecha de la solicitud" }
        sede_id: { type: integer, description: "ID de la sede" }
        hospital_id: { type: integer, description: "ID del hospital" }
        status: { type: string, enum: [pendiente, en_proceso, completada, cancelada], default: pendiente, description: "Estado de la solicitud" }

    AlmacenPrincipalRequest:
      type: object
      properties:
        nombre: { type: string }
        sede_id: { type: integer }
        descripcion: { type: string }

    AlmacenCentralRequest:
      type: object
      properties:
        nombre: { type: string }
        sede_id: { type: integer }
        descripcion: { type: string }

    AlmacenFarmaciaRequest:
      type: object
      properties:
        nombre: { type: string }
        sede_id: { type: integer }
        descripcion: { type: string }

    AlmacenParaleloRequest:
      type: object
      properties:
        nombre: { type: string }
        sede_id: { type: integer }
        descripcion: { type: string }

    AlmacenServiciosAtencionesRequest:
      type: object
      properties:
        nombre: { type: string }
        sede_id: { type: integer }
        descripcion: { type: string }

    AlmacenServiciosApoyoRequest:
      type: object
      properties:
        nombre: { type: string }
        sede_id: { type: integer }
        descripcion: { type: string }

    InsumoRequest:
      type: object
      properties:
        codigo: { type: string }
        descripcion: { type: string }
        unidad_medida: { type: string }
        tipo: { type: string }

    LoteRequest:
      type: object
      properties:
        numero_lote: { type: string }
        fecha_vencimiento: { type: string, format: date }
        cantidad_inicial: { type: integer }

    LoteGrupoRequest:
      type: object
      properties:
        codigo: { type: string }
        items: { type: array }

    LoteGrupoMovimientoRequest:
      type: object
      properties:
        origen_central_id: { type: integer }
        hospital_id: { type: integer }
        principal_id: { type: integer }
        tipo_movimiento: { type: string }
        fecha_despacho: { type: string, format: date }
        items: { type: array }

    MovimientoCentralSalidaRequest:
      type: object
      required: 
        - origen_hospital_id
        - origen_sede_id
        - destino_hospital_id
        - destino_sede_id
        - origen_almacen_tipo
        - destino_almacen_tipo
        - tipo_movimiento
        - fecha_despacho
        - items
      properties:
        origen_hospital_id:
          type: integer
          minimum: 1
          description: ID del hospital de origen
        origen_sede_id:
          type: integer
          minimum: 1
          description: ID de la sede de origen
        destino_hospital_id:
          type: integer
          minimum: 1
          description: ID del hospital de destino
        destino_sede_id:
          type: integer
          minimum: 1
          description: ID de la sede de destino
        origen_almacen_tipo:
          type: string
          maxLength: 100
          description: Tipo de almacén de origen
          example: almacenCent
          enum: [almacenCent]
        destino_almacen_tipo:
          type: string
          maxLength: 100
          description: Tipo de almacén de destino
          example: almacenPrin
          enum: [almacenPrin, almacenFarm, almacenPar, almacenServApoyo, almacenServAtencion]
        tipo_movimiento:
          type: string
          maxLength: 50
          description: Tipo de movimiento
          example: despacho
        fecha_despacho:
          type: string
          format: date
          description: Fecha del despacho
        observaciones:
          type: string
          nullable: true
          maxLength: 500
          description: Observaciones del movimiento
        items:
          type: array
          minItems: 1
          description: Lista de lotes y cantidades a transferir
          items:
            type: object
            required: [lote_id, cantidad]
            properties:
              lote_id:
                type: integer
                minimum: 1
                description: ID del lote a transferir
              cantidad:
                type: integer
                minimum: 1
                description: Cantidad a transferir del lote

    MovimientoPrincipalEntradaRequest:
      type: object
      required: [movimiento_stock_id, fecha_recepcion, user_id_receptor, items]
      properties:
        movimiento_stock_id:
          type: integer
          minimum: 1
          description: ID del movimiento de stock a recibir
        fecha_recepcion:
          type: string
          format: date
          description: Fecha de recepción de los items
        user_id_receptor:
          type: integer
          minimum: 1
          description: ID del usuario que recibe los items
        items:
          type: array
          minItems: 1
          description: Lista de lotes recibidos con sus cantidades
          items:
            type: object
            required: [lote_id, cantidad]
            properties:
              lote_id:
                type: integer
                minimum: 1
                description: ID del lote recibido
              cantidad:
                type: integer
                minimum: 1
                description: Cantidad recibida del lote

    MovimientoPrincipalEntradaResponse:
      type: object
      properties:
        status:
          type: boolean
          example: true
        mensaje:
          type: string
          example: Recepción confirmada y stock actualizado.
        data:
          type: object
          properties:
            estado:
              type: string
              enum: [completado, inconsistente]
            discrepancias:
              type: array
              items:
                type: object
                properties:
                  lote_id:
                    type: integer
                  cantidad_esperada:
                    type: integer
                  cantidad_recibida:
                    type: integer

    MovimientoStockRequest:
      type: object
      required:
        - tipo
        - tipo_movimiento
        - destino_hospital_id
        - destino_sede_id
        - origen_almacen_tipo
        - origen_almacen_id
        - destino_almacen_tipo
        - destino_almacen_id
        - cantidad
      properties:
        tipo:
          type: string
          maxLength: 50
          example: transferencia
        tipo_movimiento:
          type: string
          maxLength: 50
          example: despacho
        origen_hospital_id:
          type: integer
          nullable: true
          minimum: 1
        origen_sede_id:
          type: integer
          nullable: true
          minimum: 1
        destino_hospital_id:
          type: integer
          minimum: 1
        destino_sede_id:
          type: integer
          minimum: 1
        origen_almacen_tipo:
          type: string
          maxLength: 100
          example: almacenCent
        origen_almacen_id:
          type: integer
          minimum: 0
        destino_almacen_tipo:
          type: string
          maxLength: 100
          example: almacenPrin
        destino_almacen_id:
          type: integer
          minimum: 0
        cantidad:
          type: integer
          minimum: 0
        fecha_despacho:
          type: string
          format: date
        observaciones:
          type: string
          nullable: true
          maxLength: 500
        fecha_recepcion:
          type: string
          format: date
          nullable: true
        observaciones_recepcion:
          type: string
          nullable: true
          maxLength: 500
        estado:
          type: string
          enum: [pendiente, completado, inconsistente, cancelado]
        codigo_grupo:
          type: string
          nullable: true
          maxLength: 50
        user_id:
          type: integer
          minimum: 1
        user_id_receptor:
          type: integer
          nullable: true
          minimum: 1

    MovimientoDiscrepanciaRequest:
      type: object
      properties:
        movimiento_stock_id:
          type: integer
          minimum: 1
          description: ID del movimiento de stock
        codigo_lote_grupo:
          type: string
          maxLength: 50
          description: Código del lote grupo donde ocurrió la discrepancia
        cantidad_esperada:
          type: integer
          minimum: 0
          description: Cantidad que se esperaba recibir
        cantidad_recibida:
          type: integer
          minimum: 0
          description: Cantidad que realmente se recibió
        observaciones:
          type: string
          nullable: true
          maxLength: 500
          description: Observaciones sobre la discrepancia

    FichaInsumoRequest:
      type: object
      properties:
        hospital_id:
          type: integer
          minimum: 1
        insumo_id:
          type: integer
          minimum: 1
        cantidad:
          type: integer
          minimum: 0
        status:
          type: boolean

    DistribucionPrincipalRequest:
      type: object
      properties:
        origen_central_id: { type: integer }
        items: { type: array }

    DistribucionAutomaticaRequest:
      type: object
      properties:
        lote_ids: { type: array, items: { type: integer } }
        estrategia: { type: string, enum: [porcentaje] }

    # Seguimientos Schemas
    SeguimientoRequest:
      type: object
      required: [movimiento_stock_id, estado, user_id_repartidor]
      properties:
        movimiento_stock_id:
          type: integer
          minimum: 1
          description: ID del movimiento de stock
        ubicacion:
          type: object
          nullable: true
          properties:
            lat:
              type: number
              description: Latitud GPS
            lng:
              type: number
              description: Longitud GPS
            direccion:
              type: string
              maxLength: 500
              description: Dirección textual
        estado:
          type: string
          enum: [despachado, en_camino, entregado]
          description: Estado del seguimiento
        status:
          type: string
          enum: [activo, completado]
          default: activo
          description: Status del seguimiento
        observaciones:
          type: string
          maxLength: 1000
          nullable: true
          description: Observaciones del repartidor
        user_id_repartidor:
          type: integer
          minimum: 1
          description: ID del usuario repartidor

    SeguimientoUpdateRequest:
      type: object
      properties:
        ubicacion:
          type: object
          nullable: true
          properties:
            lat:
              type: number
            lng:
              type: number
            direccion:
              type: string
              maxLength: 500
        estado:
          type: string
          enum: [despachado, en_camino, entregado]
        status:
          type: string
          enum: [activo, completado]
        observaciones:
          type: string
          maxLength: 1000
          nullable: true

    SeguimientoResponse:
      type: object
      properties:
        id:
          type: integer
        movimiento_stock_id:
          type: integer
        ubicacion:
          type: object
          nullable: true
        estado:
          type: string
        status:
          type: string
        observaciones:
          type: string
          nullable: true
        user_id_repartidor:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        movimiento_stock:
          type: object
        repartidor:
          type: object
          properties:
            id:
              type: integer
            nombre:
              type: string
            apellido:
              type: string

    # Repartidor Schemas
    RepartidorSeguimientoRequest:
      type: object
      required: [movimiento_stock_id, despachador_id, estado]
      properties:
        movimiento_stock_id:
          type: integer
          minimum: 1
          description: ID del movimiento a actualizar
        despachador_id:
          type: integer
          minimum: 1
          description: ID del usuario que despacha/asigna el movimiento
        estado:
          type: string
          enum: [despachado, en_camino, entregado]
          description: Nuevo estado del movimiento
        ubicacion:
          type: object
          nullable: true
          properties:
            lat:
              type: number
              description: Latitud GPS actual
            lng:
              type: number
              description: Longitud GPS actual
            direccion:
              type: string
              maxLength: 500
              description: Dirección actual
        observaciones:
          type: string
          maxLength: 1000
          nullable: true
          description: Observaciones del repartidor

  /api/cedula/consultar:
    post:
      summary: Consultar datos de cédula venezolana
      description: |
        Consulta los datos personales y de registro electoral de una cédula venezolana mediante scraping de la página sistemaspnp.com.
        
        **Proceso automático:**
        1. Obtiene la página inicial y extrae el CAPTCHA matemático
        2. Resuelve automáticamente la suma del CAPTCHA (números del 1 al 10)
        3. Envía el formulario con la cédula y respuesta del CAPTCHA
        4. Extrae y estructura los datos del resultado
        
        **Datos obtenidos:**
        - **Datos Personales:** Cédula, RIF, nombres y apellidos
        - **Datos CNE:** Estado, municipio, parroquia y centro electoral
        
        **Validaciones:**
        - La cédula debe tener entre 6 y 8 dígitos
        - Solo números sin letras ni caracteres especiales
        
        **Nota:** Este endpoint realiza scraping de un sitio externo. El tiempo de respuesta puede variar según la disponibilidad del servicio.
      tags: [Utilidades]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - cedula
              properties:
                cedula:
                  type: string
                  pattern: '^\d{6,8}$'
                  example: "18481144"
                  description: Número de cédula venezolana (6 a 8 dígitos)
      responses:
        '200':
          description: Consulta procesada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: "Datos de cédula obtenidos exitosamente."
                  data:
                    type: object
                    properties:
                      cedula:
                        type: string
                        example: "18481144"
                        description: Número de cédula
                      rif:
                        type: string
                        example: "V184811444"
                        description: RIF asociado a la cédula
                      primer_apellido:
                        type: string
                        example: "GARCIA"
                        description: Primer apellido
                      segundo_apellido:
                        type: string
                        example: "ESSER"
                        description: Segundo apellido
                      nombres:
                        type: string
                        example: "JOSEPH AUGUSTO"
                        description: Nombres completos
                      estado:
                        type: string
                        example: "FALCON"
                        description: Estado de registro electoral
                      municipio:
                        type: string
                        example: "MIRANDA"
                        description: Municipio de registro electoral
                      parroquia:
                        type: string
                        example: "SAN GABRIEL"
                        description: Parroquia de registro electoral
                      centro_electoral:
                        type: string
                        example: "ESCUELA PREVOCACIONAL FRANCISCO DE MIRANDA"
                        description: Centro electoral asignado
        '200 (error)':
          description: Error en la consulta
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  mensaje:
                    type: string
                    example: "No se encontraron datos para la cédula proporcionada."
                  data:
                    type: null
              examples:
                no_encontrado:
                  summary: Cédula no encontrada
                  value:
                    status: false
                    mensaje: "No se encontraron datos para la cédula proporcionada."
                    data: null
                error_conexion:
                  summary: Error de conexión
                  value:
                    status: false
                    mensaje: "Error al conectar con el servicio de consulta."
                    data: null
                error_captcha:
                  summary: Error en CAPTCHA
                  value:
                    status: false
                    mensaje: "No se pudo extraer el CAPTCHA de la página."
                    data: null
        '400':
          description: Datos de entrada inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StandardResponse'
